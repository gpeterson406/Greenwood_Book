<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Two-Way ANOVA | Intermediate Statistics with R</title>
  <meta name="description" content="Chapter 4 Two-Way ANOVA | Intermediate Statistics with R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Two-Way ANOVA | Intermediate Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="gpeterson406/Greenwood_Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Two-Way ANOVA | Intermediate Statistics with R" />
  
  
  

<meta name="author" content="Mark C Greenwood" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter3.html"/>
<link rel="next" href="chapter5.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intermediate Statistics with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Cover</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#section1-1"><i class="fa fa-check"></i><b>1.1</b> Overview of methods</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#section1-2"><i class="fa fa-check"></i><b>1.2</b> Getting started in R</a></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#section1-3"><i class="fa fa-check"></i><b>1.3</b> Basic summary statistics, histograms, and boxplots using R</a></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#section1-4"><i class="fa fa-check"></i><b>1.4</b> R Markdown</a></li>
<li class="chapter" data-level="1.5" data-path="chapter1.html"><a href="chapter1.html#section1-5"><i class="fa fa-check"></i><b>1.5</b> Grammar of Graphics</a></li>
<li class="chapter" data-level="1.6" data-path="chapter1.html"><a href="chapter1.html#section1-6"><i class="fa fa-check"></i><b>1.6</b> Exiting RStudio</a></li>
<li class="chapter" data-level="1.7" data-path="chapter1.html"><a href="chapter1.html#section1-7"><i class="fa fa-check"></i><b>1.7</b> Chapter summary</a></li>
<li class="chapter" data-level="1.8" data-path="chapter1.html"><a href="chapter1.html#section1-8"><i class="fa fa-check"></i><b>1.8</b> Summary of important R code</a></li>
<li class="chapter" data-level="1.9" data-path="chapter1.html"><a href="chapter1.html#section1-9"><i class="fa fa-check"></i><b>1.9</b> Practice problems</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> (R)e-Introduction to statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#section2-1"><i class="fa fa-check"></i><b>2.1</b> Data wrangling and density curves</a></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#section2-2"><i class="fa fa-check"></i><b>2.2</b> Pirate-plots</a></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#section2-3"><i class="fa fa-check"></i><b>2.3</b> Models, hypotheses, and permutations for the two sample mean situation</a></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#section2-4"><i class="fa fa-check"></i><b>2.4</b> Permutation testing for the two sample mean situation</a></li>
<li class="chapter" data-level="2.5" data-path="chapter2.html"><a href="chapter2.html#section2-5"><i class="fa fa-check"></i><b>2.5</b> Hypothesis testing (general)</a></li>
<li class="chapter" data-level="2.6" data-path="chapter2.html"><a href="chapter2.html#section2-6"><i class="fa fa-check"></i><b>2.6</b> Connecting randomization (nonparametric) and parametric tests</a></li>
<li class="chapter" data-level="2.7" data-path="chapter2.html"><a href="chapter2.html#section2-7"><i class="fa fa-check"></i><b>2.7</b> Second example of permutation tests</a></li>
<li class="chapter" data-level="2.8" data-path="chapter2.html"><a href="chapter2.html#section2-8"><i class="fa fa-check"></i><b>2.8</b> Reproducibility Crisis: Moving beyond p &lt; 0.05, publication bias, and multiple testing issues</a></li>
<li class="chapter" data-level="2.9" data-path="chapter2.html"><a href="chapter2.html#section2-9"><i class="fa fa-check"></i><b>2.9</b> Confidence intervals and bootstrapping</a></li>
<li class="chapter" data-level="2.10" data-path="chapter2.html"><a href="chapter2.html#section2-10"><i class="fa fa-check"></i><b>2.10</b> Bootstrap confidence intervals for difference in GPAs</a></li>
<li class="chapter" data-level="2.11" data-path="chapter2.html"><a href="chapter2.html#section2-11"><i class="fa fa-check"></i><b>2.11</b> Chapter summary</a></li>
<li class="chapter" data-level="2.12" data-path="chapter2.html"><a href="chapter2.html#section2-12"><i class="fa fa-check"></i><b>2.12</b> Summary of important R code</a></li>
<li class="chapter" data-level="2.13" data-path="chapter2.html"><a href="chapter2.html#section2-13"><i class="fa fa-check"></i><b>2.13</b> Practice problems</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#section3-1"><i class="fa fa-check"></i><b>3.1</b> Situation</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#section3-2"><i class="fa fa-check"></i><b>3.2</b> Linear model for One-Way ANOVA (cell means and reference-coding)</a></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#section3-3"><i class="fa fa-check"></i><b>3.3</b> One-Way ANOVA Sums of Squares, Mean Squares, and F-test</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#section3-4"><i class="fa fa-check"></i><b>3.4</b> ANOVA model diagnostics including QQ-plots</a></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#section3-5"><i class="fa fa-check"></i><b>3.5</b> Guinea pig tooth growth One-Way ANOVA example</a></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#section3-6"><i class="fa fa-check"></i><b>3.6</b> Multiple (pair-wise) comparisons using Tukey’s HSD and the compact letter display</a></li>
<li class="chapter" data-level="3.7" data-path="chapter3.html"><a href="chapter3.html#section3-7"><i class="fa fa-check"></i><b>3.7</b> Pair-wise comparisons for the Overtake data</a></li>
<li class="chapter" data-level="3.8" data-path="chapter3.html"><a href="chapter3.html#section3-8"><i class="fa fa-check"></i><b>3.8</b> Chapter summary</a></li>
<li class="chapter" data-level="3.9" data-path="chapter3.html"><a href="chapter3.html#section3-9"><i class="fa fa-check"></i><b>3.9</b> Summary of important R code</a></li>
<li class="chapter" data-level="3.10" data-path="chapter3.html"><a href="chapter3.html#section3-10"><i class="fa fa-check"></i><b>3.10</b> Practice problems</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> Two-Way ANOVA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#section4-1"><i class="fa fa-check"></i><b>4.1</b> Situation</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#section4-2"><i class="fa fa-check"></i><b>4.2</b> Designing a two-way experiment and visualizing results</a></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#section4-3"><i class="fa fa-check"></i><b>4.3</b> Two-Way ANOVA models and hypothesis tests</a></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#section4-4"><i class="fa fa-check"></i><b>4.4</b> Guinea pig tooth growth analysis with Two-Way ANOVA</a></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#section4-5"><i class="fa fa-check"></i><b>4.5</b> Observational study example: The Psychology of Debt</a></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#section4-6"><i class="fa fa-check"></i><b>4.6</b> Pushing Two-Way ANOVA to the limit: Un-replicated designs and Estimability</a></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#section4-7"><i class="fa fa-check"></i><b>4.7</b> Chapter summary</a></li>
<li class="chapter" data-level="4.8" data-path="chapter4.html"><a href="chapter4.html#section4-8"><i class="fa fa-check"></i><b>4.8</b> Summary of important R code</a></li>
<li class="chapter" data-level="4.9" data-path="chapter4.html"><a href="chapter4.html#section4-9"><i class="fa fa-check"></i><b>4.9</b> Practice problems</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> Chi-square tests</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#section5-1"><i class="fa fa-check"></i><b>5.1</b> Situation, contingency tables, and tableplots</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#section5-2"><i class="fa fa-check"></i><b>5.2</b> Homogeneity test hypotheses</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#section5-3"><i class="fa fa-check"></i><b>5.3</b> Independence test hypotheses</a></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#section5-4"><i class="fa fa-check"></i><b>5.4</b> Models for R by C tables</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#section5-5"><i class="fa fa-check"></i><b>5.5</b> Permutation tests for the <span class="math inline">\(X^2\)</span> statistic</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#section5-6"><i class="fa fa-check"></i><b>5.6</b> Chi-square distribution for the <span class="math inline">\(X^2\)</span> statistic</a></li>
<li class="chapter" data-level="5.7" data-path="chapter5.html"><a href="chapter5.html#section5-7"><i class="fa fa-check"></i><b>5.7</b> Examining residuals for the source of differences</a></li>
<li class="chapter" data-level="5.8" data-path="chapter5.html"><a href="chapter5.html#section5-8"><i class="fa fa-check"></i><b>5.8</b> General protocol for <span class="math inline">\(X^2\)</span> tests</a></li>
<li class="chapter" data-level="5.9" data-path="chapter5.html"><a href="chapter5.html#section5-9"><i class="fa fa-check"></i><b>5.9</b> Political party and voting results: Complete analysis</a></li>
<li class="chapter" data-level="5.10" data-path="chapter5.html"><a href="chapter5.html#section5-10"><i class="fa fa-check"></i><b>5.10</b> Is cheating and lying related in students?</a></li>
<li class="chapter" data-level="5.11" data-path="chapter5.html"><a href="chapter5.html#section5-11"><i class="fa fa-check"></i><b>5.11</b> Analyzing a stratified random sample of California schools</a></li>
<li class="chapter" data-level="5.12" data-path="chapter5.html"><a href="chapter5.html#section5-12"><i class="fa fa-check"></i><b>5.12</b> Chapter summary</a></li>
<li class="chapter" data-level="5.13" data-path="chapter5.html"><a href="chapter5.html#section5-13"><i class="fa fa-check"></i><b>5.13</b> Summary of important R commands</a></li>
<li class="chapter" data-level="5.14" data-path="chapter5.html"><a href="chapter5.html#section5-14"><i class="fa fa-check"></i><b>5.14</b> Practice problems</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> Correlation and Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#section6-1"><i class="fa fa-check"></i><b>6.1</b> Relationships between two quantitative variables</a></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#section6-2"><i class="fa fa-check"></i><b>6.2</b> Estimating the correlation coefficient</a></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#section6-3"><i class="fa fa-check"></i><b>6.3</b> Relationships between variables by groups</a></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#section6-4"><i class="fa fa-check"></i><b>6.4</b> Inference for the correlation coefficient</a></li>
<li class="chapter" data-level="6.5" data-path="chapter6.html"><a href="chapter6.html#section6-5"><i class="fa fa-check"></i><b>6.5</b> Are tree diameters related to tree heights?</a></li>
<li class="chapter" data-level="6.6" data-path="chapter6.html"><a href="chapter6.html#section6-6"><i class="fa fa-check"></i><b>6.6</b> Describing relationships with a regression model</a></li>
<li class="chapter" data-level="6.7" data-path="chapter6.html"><a href="chapter6.html#section6-7"><i class="fa fa-check"></i><b>6.7</b> Least Squares Estimation</a></li>
<li class="chapter" data-level="6.8" data-path="chapter6.html"><a href="chapter6.html#section6-8"><i class="fa fa-check"></i><b>6.8</b> Measuring the strength of regressions: R<sup>2</sup></a></li>
<li class="chapter" data-level="6.9" data-path="chapter6.html"><a href="chapter6.html#section6-9"><i class="fa fa-check"></i><b>6.9</b> Outliers: leverage and influence</a></li>
<li class="chapter" data-level="6.10" data-path="chapter6.html"><a href="chapter6.html#section6-10"><i class="fa fa-check"></i><b>6.10</b> Residual diagnostics – setting the stage for inference</a></li>
<li class="chapter" data-level="6.11" data-path="chapter6.html"><a href="chapter6.html#section6-11"><i class="fa fa-check"></i><b>6.11</b> Old Faithful discharge and waiting times</a></li>
<li class="chapter" data-level="6.12" data-path="chapter6.html"><a href="chapter6.html#section6-12"><i class="fa fa-check"></i><b>6.12</b> Chapter summary</a></li>
<li class="chapter" data-level="6.13" data-path="chapter6.html"><a href="chapter6.html#section6-13"><i class="fa fa-check"></i><b>6.13</b> Summary of important R code</a></li>
<li class="chapter" data-level="6.14" data-path="chapter6.html"><a href="chapter6.html#section6-14"><i class="fa fa-check"></i><b>6.14</b> Practice problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> Simple linear regression inference</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#section7-1"><i class="fa fa-check"></i><b>7.1</b> Model</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#section7-2"><i class="fa fa-check"></i><b>7.2</b> Confidence interval and hypothesis tests for the slope and intercept</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#section7-3"><i class="fa fa-check"></i><b>7.3</b> Bozeman temperature trend</a></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#section7-4"><i class="fa fa-check"></i><b>7.4</b> Randomization-based inferences for the slope coefficient</a></li>
<li class="chapter" data-level="7.5" data-path="chapter7.html"><a href="chapter7.html#section7-5"><i class="fa fa-check"></i><b>7.5</b> Transformations part I: Linearizing relationships</a></li>
<li class="chapter" data-level="7.6" data-path="chapter7.html"><a href="chapter7.html#section7-6"><i class="fa fa-check"></i><b>7.6</b> Transformations part II: Impacts on SLR interpretations: log(y), log(x), &amp; both log(y) &amp; log(x)</a></li>
<li class="chapter" data-level="7.7" data-path="chapter7.html"><a href="chapter7.html#section7-7"><i class="fa fa-check"></i><b>7.7</b> Confidence interval for the mean and prediction intervals for a new observation</a></li>
<li class="chapter" data-level="7.8" data-path="chapter7.html"><a href="chapter7.html#section7-8"><i class="fa fa-check"></i><b>7.8</b> Chapter summary</a></li>
<li class="chapter" data-level="7.9" data-path="chapter7.html"><a href="chapter7.html#section7-9"><i class="fa fa-check"></i><b>7.9</b> Summary of important R code</a></li>
<li class="chapter" data-level="7.10" data-path="chapter7.html"><a href="chapter7.html#section7-10"><i class="fa fa-check"></i><b>7.10</b> Practice problems</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#section8-1"><i class="fa fa-check"></i><b>8.1</b> Going from SLR to MLR</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#section8-2"><i class="fa fa-check"></i><b>8.2</b> Validity conditions in MLR</a></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#section8-3"><i class="fa fa-check"></i><b>8.3</b> Interpretation of MLR terms</a></li>
<li class="chapter" data-level="8.4" data-path="chapter8.html"><a href="chapter8.html#section8-4"><i class="fa fa-check"></i><b>8.4</b> Comparing multiple regression models</a></li>
<li class="chapter" data-level="8.5" data-path="chapter8.html"><a href="chapter8.html#section8-5"><i class="fa fa-check"></i><b>8.5</b> General recommendations for MLR interpretations and VIFs</a></li>
<li class="chapter" data-level="8.6" data-path="chapter8.html"><a href="chapter8.html#section8-6"><i class="fa fa-check"></i><b>8.6</b> MLR inference: Parameter inferences using the t-distribution</a></li>
<li class="chapter" data-level="8.7" data-path="chapter8.html"><a href="chapter8.html#section8-7"><i class="fa fa-check"></i><b>8.7</b> Overall F-test in multiple linear regression</a></li>
<li class="chapter" data-level="8.8" data-path="chapter8.html"><a href="chapter8.html#section8-8"><i class="fa fa-check"></i><b>8.8</b> Case study: First year college GPA and SATs</a></li>
<li class="chapter" data-level="8.9" data-path="chapter8.html"><a href="chapter8.html#section8-9"><i class="fa fa-check"></i><b>8.9</b> Different intercepts for different groups: MLR with indicator variables</a></li>
<li class="chapter" data-level="8.10" data-path="chapter8.html"><a href="chapter8.html#section8-10"><i class="fa fa-check"></i><b>8.10</b> Additive MLR with more than two groups: Headache example</a></li>
<li class="chapter" data-level="8.11" data-path="chapter8.html"><a href="chapter8.html#section8-11"><i class="fa fa-check"></i><b>8.11</b> Different slopes and different intercepts</a></li>
<li class="chapter" data-level="8.12" data-path="chapter8.html"><a href="chapter8.html#section8-12"><i class="fa fa-check"></i><b>8.12</b> F-tests for MLR models with quantitative and categorical variables and interactions</a></li>
<li class="chapter" data-level="8.13" data-path="chapter8.html"><a href="chapter8.html#section8-13"><i class="fa fa-check"></i><b>8.13</b> AICs for model selection</a></li>
<li class="chapter" data-level="8.14" data-path="chapter8.html"><a href="chapter8.html#section8-14"><i class="fa fa-check"></i><b>8.14</b> Case study: Forced expiratory volume model selection using AICs</a></li>
<li class="chapter" data-level="8.15" data-path="chapter8.html"><a href="chapter8.html#section8-15"><i class="fa fa-check"></i><b>8.15</b> Chapter summary</a></li>
<li class="chapter" data-level="8.16" data-path="chapter8.html"><a href="chapter8.html#section8-16"><i class="fa fa-check"></i><b>8.16</b> Summary of important R code</a></li>
<li class="chapter" data-level="8.17" data-path="chapter8.html"><a href="chapter8.html#section8-17"><i class="fa fa-check"></i><b>8.17</b> Practice problems</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> Case studies</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#section9-1"><i class="fa fa-check"></i><b>9.1</b> Overview of material covered</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#section9-2"><i class="fa fa-check"></i><b>9.2</b> The impact of simulated chronic nitrogen deposition on the biomass and N2-fixation activity of two boreal feather moss–cyanobacteria associations</a></li>
<li class="chapter" data-level="9.3" data-path="chapter9.html"><a href="chapter9.html#section9-3"><i class="fa fa-check"></i><b>9.3</b> Ants learn to rely on more informative attributes during decision-making</a></li>
<li class="chapter" data-level="9.4" data-path="chapter9.html"><a href="chapter9.html#section9-4"><i class="fa fa-check"></i><b>9.4</b> Multi-variate models are essential for understanding vertebrate diversification in deep time</a></li>
<li class="chapter" data-level="9.5" data-path="chapter9.html"><a href="chapter9.html#section9-5"><i class="fa fa-check"></i><b>9.5</b> What do didgeridoos really do about sleepiness?</a></li>
<li class="chapter" data-level="9.6" data-path="chapter9.html"><a href="chapter9.html#section9-6"><i class="fa fa-check"></i><b>9.6</b> General summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intermediate Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter4" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Two-Way ANOVA</h1>
<div id="section4-1" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Situation</h2>
<p>In this chapter, we extend the One-Way ANOVA to situations with two factors or categorical explanatory
variables in a method that is generally called the <strong><em>Two-Way ANOVA</em></strong>.
 
This
allows researchers to simultaneously study two variables that might
explain variability in the responses and explore whether the impacts of one explanatory
variable change depending on the level of the other explanatory variable. In some situations, each
observation is so expensive that researchers want to use a single study to
explore two different sets of research questions in the same round of data
collection. For example, a company might want to study factors that affect the
number of defective products per day and are interested in the impacts of two
different types of training programs and three different levels of production
quotas. These methods would allow engineers to compare the training programs,
production quotas, and see if the training programs “work differently” for
different production quotas. In a clinical trials context, it is well known
that certain factors can change the performance of certain drugs. For example,
different dosages of a drug might have different benefits or side-effects on
men, versus women or children or even for different age groups in adults. <strong>When the impact of one factor on the response changes depending on the level of another factor</strong>, we say that the two explanatory variables <strong><em>interact</em></strong>.

It is also possible
for both factors to be related to differences in the mean responses and not
interact. For example, suppose there is a difference in the
response variable means between young and old subjects and a difference in the responses among various dosages,
but the effect of increasing the dosage is the same for both young and old
subjects. This is an example of what is called an <strong><em>additive</em></strong> type of model.
In general, the world is more complicated than the single factor models we
considered in Chapter <a href="chapter3.html#chapter3">3</a> can account for, especially in
observational studies, so these models allow us to start to handle more
realistic situations.
</p>
<p>Consider the following “experiment” where we want to compare the strength of
different brands of paper towels when they are wet. The response variable
will be the time to failure in seconds (a continuous response variable) when
a weight is placed on the towel held at the four corners. We are interested
in studying the differences between brands and the impact of different amounts
of water applied to the towels.</p>
<ul>
<li><p>Predictors (Explanatory Variables): <strong>A</strong>: <code>Brand</code> (2 brands of interest,
named <em>B1</em> and <em>B2</em>) and <strong>B</strong>: Number of <code>Drops</code> of water (10, 20, 30 drops).</p></li>
<li><p>Response: <em>Time</em> to failure (in seconds) of a towel (<span class="math inline">\(y\)</span>) with a weight
sitting in the middle of the towel.</p></li>
</ul>
</div>
<div id="section4-2" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Designing a two-way experiment and visualizing results</h2>
<p>Ideally, we want to randomly assign the levels of each factor so that we can
attribute causality to any detected effects and to reduce the chances of
<em>confounding</em>, where the differences we think are due to one explanatory variable might be due to another variable that varied with the this explanatory variable of interest.


Because there are two factors, we would need to design a random
assignment scheme to select the levels of both variables. For example, we could
randomly select a brand and then randomly select the number of drops to apply
from the levels chosen for each measurement. Or we could decide on how many
observations we want at each combination of the two factors (ideally having
them all equal so the design is <strong><em>balanced</em></strong>) and then randomize the order
of applying the different combinations of levels.
</p>
<p>Why might it be important to randomly apply the brand and number of drops in
an experiment? There are situations where the order of observations can be
related to changes in the responses and we want to be able to eliminate
the order of observations from being related to the levels of the factors – otherwise the order of observations and levels of the factors would be <em>confounded</em>.
For example, suppose that the area where the experiment is being performed
becomes wet over time and the later measurements have extra water that gets
onto the paper towels and they tend to fail more quickly. If all the observations
for the second brand were done later in the study, then the <em>order of observations</em>
impacts could make the second brand look worse. If the order of measurements to be made is
randomized, then even if there is some drift in the responses over the order
of observations it should still be possible to see the differences in the
randomly assigned effects. If the study incorporates repeated measurements on human or animal subjects, randomizing the order of treatments they are exposed to can
alleviate impacts of them “learning” through the study or changing just due to being studied, something that we
would not have to worry about with paper towels.</p>
<p>In observational studies, we do not have the luxury of random assignment, that
is, we cannot randomly assign levels of the treatment variables to our
subjects, so we cannot guarantee that the only differences between the groups
are based on the differences in the explanatory variables.
 
As discussed before, because we can’t control
which level of the variables are assigned to the subjects, we cannot make
causal inferences and have to worry about other variables being the real
drivers of the results. Although we can never establish causal inference
with observational studies, we can generalize our results to a larger
population if we have a representative (ideally random) sample from our population of interest.</p>
<p>It is also possible that we might have studies where some of the variables are
randomly assigned and others that are not randomly assignable. The most common
versions of this are what we sometimes call subject “demographics,” such as
gender, income, race, etc. We might be performing a study where we can randomly
assign treatments to these subjects but might also want to account for
differences based on income level, which we can’t assign. In these cases, the
scope of inference gets complicated – differences seen on randomized variables
can be causally interpreted but you have to be careful to not say that the
demographics caused differences. Suppose that a randomly assigned drug dosage
is found to show positive differences in older adults and negative changes in younger adults. We
could say that the dosage causes the increases in older adults and decreases in younger ones, but we can’t say that age caused the differences in the responses – it just modified how the drug works and what the drug caused to happen in the responses.
</p>
<p>Even when we do have random assignment of treatments it is important to think
about who/what is included in the sample. To get back to the paper towel
example, we are probably interested in more than the sheets of the rolls
we have to work with. If we could randomly select the studied paper towels
from all paper towels made by each brand, our conclusions could be extended
to those populations. That probably would not be practical, but trying to
make sure that the towels are representative of all made by each brand by
checking for defects and maybe picking towels from a few different rolls
would be a good start to being able to extend inferences beyond the tested
towels. But if you were doing this study in the factory, it might be possible to randomly sample from the towels produced, at least over the course of a day.</p>
<p>Once random assignment and random sampling is settled, the final aspect of
study design involves deciding on the number of observations that should be
made. The short (glib) answer is to take as many as you can afford. With more
observations comes higher power to detect differences if they exist, which
is a desired attribute of all studies.

It is also important to make sure that
you obtain multiple observations at each combination of the treatment levels,
which are called <strong><em>replicates</em></strong>.  Having replicate measurements allows
estimation of the mean for each combination of the treatment levels as well
as estimation and testing for an interaction.

And we always prefer<a href="#fn80" class="footnote-ref" id="fnref80"><sup>80</sup></a> having
balanced designs because they provide resistance to violation of some
assumptions as was discussed in Chapter <a href="chapter3.html#chapter3">3</a>. A <strong><em>balanced design</em></strong>
in a Two-Way ANOVA setting involves having the same sample size for every
combination of the levels of the two factor variables in the model.
</p>
<p>With two categorical explanatory variables, there are now five possible
scenarios for the truth. Different situations are created depending on
whether there is an interaction between the two variables,
whether both variables are important but do not interact, or whether either of the
variables matter at all.

Basically, there are five different possible outcomes
in a randomized Two-Way ANOVA study, listed in order of increasing model
complexity:</p>
<ol style="list-style-type: decimal">
<li><p>Neither A or B has an effect on the responses (nothing causes differences
in responses).</p></li>
<li><p>A has an effect, B does not (only A causes differences in responses).</p></li>
<li><p>B has an effect, A does not (only B causes differences in responses).</p></li>
<li><p>Both A and B have effects on response but no interaction (A and B both
cause differences in responses but the impacts are <em>additive</em>).</p></li>
<li><p>Effect of A on response differs based on the levels of B, the opposite is also true
(means for levels of response across A are different for different levels of B, or, simply,
A and B interact in their effect on the response).</p></li>
</ol>
<p>To illustrate these five potential outcomes, we will consider a fake version of
the paper towel example. It ended up being really messy and complicated to
actually perform the experiment as described so these data were simulated. The hope is to use this simple example to illustrate some of the Two-Way ANOVA possibilities. The first step is to understand what has been observed (number
observations at each combination of factors) and look at some summary
statistics across all the “groups.” The data set is available via the following link:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="chapter4.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb329-2"><a href="chapter4.html#cb329-2" aria-hidden="true" tabindex="-1"></a>pt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;http://www.math.montana.edu/courses/s217/documents/pt.csv&quot;</span>)</span>
<span id="cb329-3"><a href="chapter4.html#cb329-3" aria-hidden="true" tabindex="-1"></a>pt <span class="ot">&lt;-</span> pt <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">drops =</span> <span class="fu">factor</span>(drops),</span>
<span id="cb329-4"><a href="chapter4.html#cb329-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">brand =</span> <span class="fu">factor</span>(brand)</span>
<span id="cb329-5"><a href="chapter4.html#cb329-5" aria-hidden="true" tabindex="-1"></a>                    )</span></code></pre></div>
<p>The data set contains five observations per combination of treatment levels as
provided by the <code>tally</code> function. To get counts for combinations of the
variables, use the general formula of <code>tally(x1 ~ x2, data = ...)</code> – noting that the order of <code>x1</code> and <code>x2</code> doesn’t matter here:
</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="chapter4.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb330-2"><a href="chapter4.html#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(brand <span class="sc">~</span> drops, <span class="at">data =</span> pt)</span></code></pre></div>
<pre><code>##      drops
## brand 10 20 30
##    B1  5  5  5
##    B2  5  5  5</code></pre>
<p>The sample sizes in each of the six treatment level combinations of <code>Brand</code>
and <code>Drops</code> [(<em>B1</em>, 10), (<em>B1</em>, 20), (<em>B1</em>, 30), (<em>B2</em>, 10), (<em>B2</em>, 20),
(<em>B2</em>, 30)] are <span class="math inline">\(n_{jk} = 5\)</span> for <span class="math inline">\(j^{th}\)</span> level of <code>Brand</code> (<span class="math inline">\(j = 1, 2\)</span>) and
<span class="math inline">\(k^{th}\)</span> level of <code>Drops</code> (<span class="math inline">\(k = 1, 2, 3\)</span>). The <code>tally</code> function gives us an <span class="math inline">\(R\)</span> by <span class="math inline">\(C\)</span>
<strong><em>contingency table</em></strong> with <span class="math inline">\(R = 2\)</span> rows (<em>B1</em>, <em>B2</em>) and <span class="math inline">\(C = 3\)</span> columns
(10, 20, and 30).

We’ll have more fun with <span class="math inline">\(R\)</span> by <span class="math inline">\(C\)</span>
tables in Chapter <a href="chapter5.html#chapter5">5</a> – here it helps us to see the sample size in
each combination of factor levels. The <code>favstats</code> function also helps us
dig into the results for all combinations of factor levels. The notation
involves putting both factor variables after the “~” with a “<code>+</code>” between them.
In the output, the first row contains summary information for the
5 observations for <code>Brand</code> <em>B1</em> and <code>Drops</code> amount 10. It also contains the
sample size in the <code>n</code> column, although here it rolled into a new set of
rows with the standard deviations of each combination.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="chapter4.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">favstats</span>(responses <span class="sc">~</span> brand <span class="sc">+</span> drops, <span class="at">data =</span> pt)</span></code></pre></div>
<pre><code>##   brand.drops       min        Q1   median       Q3      max     mean        sd n missing
## 1       B1.10 0.3892621 1.3158737 1.906436 2.050363 2.333138 1.599015 0.7714970 5       0
## 2       B2.10 2.3078095 2.8556961 3.001147 3.043846 3.050417 2.851783 0.3140764 5       0
## 3       B1.20 0.3838299 0.7737965 1.516424 1.808725 2.105380 1.317631 0.7191978 5       0
## 4       B2.20 1.1415868 1.9382142 2.066681 2.838412 3.001200 2.197219 0.7509989 5       0
## 5       B1.30 0.2387500 0.9804284 1.226804 1.555707 1.829617 1.166261 0.6103657 5       0
## 6       B2.30 0.5470565 1.1205102 1.284117 1.511692 2.106356 1.313946 0.5686485 5       0</code></pre>
<p>The next step is to visually explore the results across the combinations
of the two explanatory variables. The pirate-plot can be extended to handle these
sorts of two-way situations using a formula that is something like <code>y ~ A * B</code>.
 The x-axis in the pirate-plot shows two rows of labels based on the two categories and the unique combinations of those categories are directly related to a displayed distribution of responses and mean and confidence interval. For example, in Figure <a href="chapter4.html#fig:Figure4-1">4.1</a>, the <code>Brand</code> with levels of <em>B1</em> and <em>B2</em> is the first row of x-axis labels and they are repeated across the three levels of <code>Drops</code>. In reading these plots, look for differences in the means across the levels of the first row variable (<code>Brand</code>) for each level of the second row variable (<code>Drops</code>) and then focus on whether those differences change across the levels of the second variable – that is an <em>interaction</em> as the differences in differences change.
Specifically, start with comparing the two brands at each amount of water.
Do the brands seem different? Certainly for 10 drops of water the two look
different but not for 30 drops, suggesting a different impact of brands based on the amount of water present. We can also look for combinations of factors
that produce the highest or lowest responses in this display. It appears that
the time to failure is highest in the low water drop groups but as the water
levels increase, the time to failure falls and the differences in the two
brands seem to decrease. The fake data seem to have relatively similar
amounts of variability and distribution shapes except for 10 drops and brand B2 – remembering that there are
only 5 observations available for describing the shape of responses for each
combination. These data were simulated using a normal distribution with
constant variance if that gives you some extra confidence in assessing these
model assumptions.</p>

<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="chapter4.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yarrr)</span>
<span id="cb334-2"><a href="chapter4.html#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb334-3"><a href="chapter4.html#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pirateplot</span>(responses <span class="sc">~</span> brand <span class="sc">*</span> drops, <span class="at">data =</span> pt, <span class="at">xlab =</span> <span class="st">&quot;Drops&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb334-4"><a href="chapter4.html#cb334-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">inf.method =</span> <span class="st">&quot;ci&quot;</span>, <span class="at">inf.disp =</span> <span class="st">&quot;line&quot;</span>, <span class="at">theme =</span> <span class="dv">2</span>, <span class="at">point.o =</span> <span class="dv">1</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-1"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-1-1.png" alt="Pirate-plot of paper towel data by Brand (first row of \(x\)-axis) and Drops (second row of \(x\)-axis)." width="75%" />
<p class="caption">
Figure 4.1: Pirate-plot of paper towel data by <code>Brand</code> (first row of <span class="math inline">\(x\)</span>-axis) and <code>Drops</code> (second row of <span class="math inline">\(x\)</span>-axis).
</p>
</div>
<p>The pirate-plots can handle situations where both variables have more than two
levels but it can sometimes get a bit cluttered to actually display the data when our analysis is going to focus on means of the responses. The means for each combination
of levels that you can find in the <code>favstats</code> output are more usefully used
in what is called an <strong><em>interaction plot</em></strong>.

Interaction plots display the mean
responses (y-axis) versus levels of one predictor variable on the x-axis,
adding points and separate lines for each level of the other predictor variable. Because
we don’t like any of the available functions in R, we wrote our own function. It is available two ways. The easiest, if it works, is to install and load the <code>catstats</code> R package <span class="citation">(<a href="#ref-R-catstats" role="doc-biblioref">M. Greenwood 2021</a>)</span>. If you are working on a local RStudio installation, the first step involves installing the <code>remotes</code> <span class="citation">(<a href="#ref-R-remotes" role="doc-biblioref">Hester et al. 2021</a>)</span> R package and then loading it – this will allow you to install <code>catstats</code> from our github<a href="#fn81" class="footnote-ref" id="fnref81"><sup>81</sup></a> repository (you can type “3” during the installation to avoid updating other packages when you do this step).</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="chapter4.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To install the catstats R package (just the first time!):</span></span>
<span id="cb335-2"><a href="chapter4.html#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(remotes)</span>
<span id="cb335-3"><a href="chapter4.html#cb335-3" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;greenwood-stat/catstats&quot;</span>)</span></code></pre></div>
<p>After that step, you can load <code>catstats</code> like any other R package, using
<code>library(catstats)</code>. Some users have experienced issues with getting this
package installed, so you can also download the needed <code>intplot</code> and
<code>intplotarray</code> functions<a href="#fn82" class="footnote-ref" id="fnref82"><sup>82</sup></a> using: </p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="chapter4.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;http://www.math.montana.edu/courses/s217/documents/intplotfunctions_v3.R&quot;</span>)</span></code></pre></div>
<p>The <code>intplot</code> function allows a formula interface like <code>Y ~ X1 * X2</code> and provides the means <span class="math inline">\(\pm\)</span> 1 SE (vertical bars) and adds a legend to help make
everything clear.</p>

<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="chapter4.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intplot</span>(responses <span class="sc">~</span> brand <span class="sc">*</span> drops, <span class="at">data =</span> pt)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-2"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-2-1.png" alt="Interaction plot of the paper towel data with Drops on the x-axis and different lines based on Brand." width="75%" />
<p class="caption">
Figure 4.2: Interaction plot of the paper towel data with <code>Drops</code> on the x-axis and different lines based on <code>Brand</code>.
</p>
</div>
<p>Interaction plots can always be made two different ways by switching the order
of the variables. Figure <a href="chapter4.html#fig:Figure4-2">4.2</a> contains <code>Drops</code> on the x-axis
and Figure <a href="chapter4.html#fig:Figure4-3">4.3</a> has <code>Brand</code> on the x-axis. Typically putting
the variable with more levels on the x-axis will make interpretation easier,
but not always. Try both and decide on the one that you like best.  </p>

<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="chapter4.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intplot</span>(responses <span class="sc">~</span> drops <span class="sc">*</span> brand, <span class="at">data =</span> pt)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-3"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-3-1.png" alt="Interaction plot of paper towel data with Brand on the x-axis and lines based on Drops." width="75%" />
<p class="caption">
Figure 4.3: Interaction plot of paper towel data with <code>Brand</code> on the x-axis and lines based on <code>Drops</code>.
</p>
</div>
<p>The formula in this function builds on our previous notation and now we include
both predictor variables with an “<code>*</code>” between them. Using an asterisk between
explanatory variables is one way of telling R to include an interaction between
the variables. While the interaction may or may not be present, the interaction
plot helps us to explore those potential differences.</p>
<p>There are a variety of aspects of the interaction plots to pay attention to.

Initially, the question to answer is whether it appears that there is an
interaction between the predictor variables.

When there is an interaction, you
will see <strong><em>non-parallel lines</em></strong> in the interaction plot.

You want to look from
left to right in the plot and assess whether the lines connecting the means are close to parallel,
relative to the amount of variability in the estimated means as represented by the SEs in the bars. If it seems that there is
clear visual evidence of non-parallel lines, then the interaction is likely
worth considering (we will use a hypothesis test to formally assess
this – see the discussion below). If the lines look to be close to parallel, then
there probably isn’t an interaction between
the variables. Without an interaction present, that means that the differences
in the response across levels of one variable doesn’t change based on the levels of the other
variable and vice-versa. This means that we can consider the <strong><em>main effects</em></strong>
of each variable on their own<a href="#fn83" class="footnote-ref" id="fnref83"><sup>83</sup></a>.


Main effects are much like the results we found in
Chapter <a href="chapter3.html#chapter3">3</a> where we can compare
means across levels of a single variable except that there are results for two
variables to extract from the model. With the presence of an interaction, it is
complicated to summarize how each variable is affecting the response variable
because their impacts change depending on the level of the other factor. And
plots like the interaction plot provide us with useful information on the pattern of those changes.</p>
<p>If the lines are not parallel, then
focus in on comparing the levels of one variable as the other variable changes.
Remember that the definition of an interaction is that the differences among
levels of one variable depends on the level of the other variable being
considered. “Visually” this means comparing the size of the differences in the
lines from left to right. In Figures <a href="chapter4.html#fig:Figure4-2">4.2</a> and <a href="chapter4.html#fig:Figure4-3">4.3</a>,
the effect of amount of water
changes based on the brand being considered. In Figure <a href="chapter4.html#fig:Figure4-3">4.3</a>,
the three lines
represent the three water levels. The difference between the brands (left to
right, <em>B1</em> to <em>B2</em>) is different depending on how much water was present. It
appears that <code>Brand</code> <em>B2</em> lasted longer at the lower water levels but that the
difference between the two brands dropped as the water levels increased. The
same story appears in Figure <a href="chapter4.html#fig:Figure4-2">4.2</a>. As the
water levels increase (left to right, 10 to 20 to 30 drops), the differences
between the two brands decrease. Of the two versions, Figure <a href="chapter4.html#fig:Figure4-2">4.2</a>
is probably easier to read here. Sometimes it is nice to see the interaction plot made both ways simultaneously, so you can also use the <code>intplotarray</code> function, which provides Figure <a href="chapter4.html#fig:Figure4-4">4.4</a>. This plot also adds pirate-plots to the off-diagonals so you can explore the main effects of each variable, if that is reasonable.
  The interaction plots can be used to
identify the best and worst mean responses for combinations of the treatment
levels. For example, 10 <code>Drops</code> and <code>Brand</code> <em>B2</em> lasts longest, on average, and 30 <code>Drops</code> with <code>Brand</code> <em>B1</em> fails fastest, on average. In any version of the plot here, the lines do not appear to be parallel suggesting that further exploration of the
interaction appears to be warranted.</p>

<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="chapter4.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intplotarray</span>(responses <span class="sc">~</span> drops <span class="sc">*</span> brand, <span class="at">data =</span> pt)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-4"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-4-1.png" alt="Interaction plot array of paper towel data with two different versions of interaction plots and pirate-plots of the responses versus each explanatory variable." width="75%" />
<p class="caption">
Figure 4.4: Interaction plot array of paper towel data with two different versions of interaction plots and pirate-plots of the responses versus each explanatory variable.
</p>
</div>
<div style="page-break-after: always;"></div>
<p>Before we get to the hypothesis tests
to formally make this assessment (you knew some sort of p-value was coming, right?),
we can visualize the 5 different scenarios that could characterize the sorts of
results you could observe in a Two-Way ANOVA situation. Figure <a href="chapter4.html#fig:Figure4-5">4.5</a>
shows 4 of the 5 scenarios. In panel (a), when there are no differences from either
variable (Scenario 1), it provides relatively parallel lines and basically no
differences either across <code>Drops</code> levels (x-axis) or <code>Brand</code> (lines). Data such as these would
likely result in little to no evidence related to a difference in brands, water
levels, or any interaction between them in this data set.</p>

<div class="figure" style="text-align: center"><span id="fig:Figure4-5"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-5-1.png" alt="Interaction plots of four possible scenarios in the paper towel study." width="75%" />
<p class="caption">
Figure 4.5: Interaction plots of four possible scenarios in the paper towel study.
</p>
</div>
<p>Scenario 2 (Figure <a href="chapter4.html#fig:Figure4-5">4.5</a> panel (b))
incorporates differences based on factor A (here that is <code>Brand</code>) but no real
difference based on the <code>Drops</code> or any interaction. This results in a clear shift between the lines for the means of the <code>Brands</code> but little to no changes in the level of those lines across water levels.
These lines are relatively parallel. We can see that <code>Brand</code> <em>B2</em> is better than
<code>Brand</code> <em>B1</em> but that is all we can show with these sorts of results.</p>
<p>Scenario 3 (Figure <a href="chapter4.html#fig:Figure4-5">4.5</a> panel (c)) flips the important variable
to B (<code>Drops</code>)
and shows decreasing average times as the water levels increase. Again, the
interaction panels show near parallel-ness in the lines and really just show differences
among the levels of the water. In both Scenarios 2 and 3, we could use a single
variable and drop the other from the model, getting back to a One-Way ANOVA
model, without losing any important information.</p>
<p>Scenario 4 (Figure <a href="chapter4.html#fig:Figure4-5">4.5</a> panel (d)) incorporates
effects of A and B, but they are <strong><em>additive</em></strong>. That means that the effect
of one variable is the same across the levels of the other variable. In this
experiment, that would mean that <code>Drops</code> has the same impact on performance
regardless of brand and that the brands differ but each type of difference is
the same regardless of levels of the other variable.
The interaction plot lines are more or less parallel but now the brands are
clearly different from each other. The plot shows the decrease in performance
based on increasing water levels and that <code>Brand</code> <em>B2</em> is better than
<code>Brand</code> <em>B1</em>. Additive effects show the same difference in lines from left to
right in the interaction plots.</p>
<p>Finally, Scenario 5 (Figure <a href="chapter4.html#fig:Figure4-6">4.6</a>) involves
an interaction between the two variables (<code>Drops</code> and <code>Brand</code>). There are many ways
that interactions can present but the main thing is to look for clearly
non-parallel lines.

As noted in the previous discussion, the <code>Drops</code> effect
appears to change depending on which level of <code>Brand</code> is being considered.
Note that the plot here described as Scenario 5 is the same as the initial plot
of the results in Figure <a href="chapter4.html#fig:Figure4-2">4.2</a>.</p>

<div class="figure" style="text-align: center"><span id="fig:Figure4-6"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-6-1.png" alt="Interaction plot of Scenario 5 where it appears that an interaction is present." width="75%" />
<p class="caption">
Figure 4.6: Interaction plot of Scenario 5 where it appears that an interaction is present.
</p>
</div>
<p>The typical modeling protocol is to start with assuming that Scenario 5 is a possible
description of the results, related to fitting what is called the
<strong><em>interaction model</em></strong>, and then attempt to simplify the model (to the
<strong><em>additive model</em></strong>) if warranted.

We need a hypothesis test to help decide if
the interaction is “real.” We start with assuming there is no interaction between the two factors in their impacts on the response and assess evidence against that null hypothesis. We need a hypothesis test
because the lines will never be exactly parallel in real data and, just like in the One-Way
ANOVA situation, the amount of variation around the lines impacts the ability
of the model to detect differences, in this case of an interaction.
</p>
</div>
<div id="section4-3" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Two-Way ANOVA models and hypothesis tests</h2>
<p>To assess interactions with two
variables, we need to fully describe models for the additive and interaction
scenarios and then develop a method for assessing evidence of the need for
different aspects of the models. First, we need to define the notation for
these models:</p>
<ul>
<li><p><span class="math inline">\(y_{ijk}\)</span> is the <span class="math inline">\(i^{th}\)</span> response from the group for level <span class="math inline">\(j\)</span> of factor A
and level <span class="math inline">\(k\)</span> of factor B</p>
<ul>
<li><p><span class="math inline">\(j = 1,\ldots,J\)</span>     <span class="math inline">\(J\)</span> is the number of levels of A</p></li>
<li><p><span class="math inline">\(k = 1,\ldots,K\)</span>     <span class="math inline">\(K\)</span> is the number of levels of B</p></li>
<li><p><span class="math inline">\(i = 1,\ldots,n_{jk}\)</span>     <span class="math inline">\(n_{jk}\)</span> is the sample size for level
<span class="math inline">\(j\)</span> of factor A and level <span class="math inline">\(k\)</span> of factor B</p></li>
<li><p><span class="math inline">\(N = \Sigma_j\Sigma_k n_{jk}\)</span> is the total sample size (sum of the number of
observations across all <span class="math inline">\(JK\)</span> groups)</p></li>
</ul></li>
</ul>
<p>We need to extend our previous discussion of reference-coded models to develop a
Two-Way ANOVA model. We start with the <strong><em>Two-Way ANOVA interaction model</em></strong>:
</p>
<p><span class="math display">\[y_{ijk} = \alpha + \tau_j + \gamma_k + \omega_{jk} + \varepsilon_{ijk},\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is the baseline group mean (for level 1 of A <strong>and</strong> level 1 of B),
<span class="math inline">\(\tau_j\)</span> is the deviation for the <strong><em>main effect</em></strong> of A from the baseline
for levels <span class="math inline">\(2,\ldots,J\)</span>, <span class="math inline">\(\gamma_k\)</span> (gamma <span class="math inline">\(k\)</span>) is the deviation for the main
effect of B from the baseline for levels <span class="math inline">\(2,\ldots,K\)</span>, and <span class="math inline">\(\omega_{jk}\)</span>
(omega <span class="math inline">\(jk\)</span>) is the adjustment for the <strong><em>interaction effect</em></strong> for level
<span class="math inline">\(j\)</span> of factor A and level <span class="math inline">\(k\)</span> of factor B for <span class="math inline">\(j = 1,\ldots,J\)</span> and <span class="math inline">\(k = 1,\ldots,K\)</span>. In this model, <span class="math inline">\(\tau_1\)</span>, <span class="math inline">\(\gamma_1\)</span>, and <span class="math inline">\(\omega_{11}\)</span> are all fixed at 0 because <span class="math inline">\(\alpha\)</span> is the mean for the combination of the baseline levels of both variables and so no adjustments are needed.
Additionally, any <span class="math inline">\(\omega_{jk}\)</span>’s that contain the baseline category of either factor A or B are also set to 0 and the model for these levels just involves <span class="math inline">\(\tau_j\)</span> or <span class="math inline">\(\gamma_k\)</span> added to the intercept. Exploring the R output will help clarify which coefficients are present or set to 0 (so not displayed) in these models. As in Chapter <a href="chapter3.html#chapter3">3</a>, R will typically choose the baseline categories
alphabetically but now it is choosing a baseline for both variables and so our
detective work will be doubled to sort this out.</p>
<p>If the interaction term is not important, usually based on the interaction test
presented below, the <span class="math inline">\(\omega_{jk}\text{&#39;s}\)</span> can be dropped from the model
and we get a model that corresponds to Scenario 4
above. Scenario 4 is where there are two main effects in the model but no interaction
between them. The <strong><em>additive Two-Way model</em></strong> is
</p>
<p><span class="math display">\[y_{ijk} = \alpha + \tau_j + \gamma_k + \varepsilon_{ijk},\]</span></p>
<p>where each component is defined as in the interaction model. The difference between
the interaction and additive models is setting all the <span class="math inline">\(\omega_{jk}\text{&#39;s}\)</span>
to 0 that are present in the interaction model. When we set parameters to 0 in
models it removes them from the model. Setting parameters to 0 is also how we will develop
our hypotheses to test for an interaction, by assessing evidence against a null hypothesis that all <span class="math inline">\(\omega_{jk}\text{&#39;s} = 0\)</span>.</p>
<p>The interaction test hypotheses are</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: No interaction between A and B on response in population <span class="math inline">\(\Leftrightarrow\)</span> All
<span class="math inline">\(\omega_{jk}\text{&#39;s} = 0\)</span>.</p></li>
<li><p><span class="math inline">\(H_A\)</span>: Interaction between A and B on response in population <span class="math inline">\(\Leftrightarrow\)</span> At least
one <span class="math inline">\(\omega_{jk}\ne 0\)</span>.</p></li>
</ul>
<p>To perform this test, a new ANOVA <span class="math inline">\(F\)</span>-test is required (presented below) but
there are also hypotheses relating to the main effects of A (<span class="math inline">\(\tau_j\text{&#39;s}\)</span>)
and B (<span class="math inline">\(\gamma_k\text{&#39;s}\)</span>).


If you decide that there is sufficient evidence against the null hypothesis
that no interaction is
present to conclude that one is likely present, then it is dangerous to ignore the interaction and test for the main effects
because important main effects can be masked by interactions (examples later).
It is important to note that, by definition, <strong>both variables matter if an interaction is found to be important</strong> so the main effect tests may not be
very interesting in an interaction model. If the interaction is found
to be important based on the test and so is retained in the model, you should focus
on the interaction model (also called the <strong><em>full model</em></strong>) in order to
understand and describe the form of the interaction among the variables.

</p>
<p>If the interaction test does not return
a small p-value and you decide that you do not have enough evidence against the null hypothesis to suggest that the interaction is needed, the interaction
can be dropped from the model. In this situation, we would re-fit the model and
focus on the results provided by the additive model – performing tests for the
two additive main effects.

For the first, but not last time, we encounter a
model with more than one variable and more than one test of potential interest. In models
with multiple variables at similar levels (here both are main effects), we are
interested in the results for each variable given that the other variable is in
the model. In many situations, including more than one variable in a model
changes the results for the other variable even if those variables do not
interact. The reason for this is more clear in Chapter <a href="chapter8.html#chapter8">8</a> and really only
matters here if we have unbalanced designs, but we need to start adding a short
modifier to our discussions of main effects – they are the results
<em>conditional on</em> or <em>adjusting for</em> or, simply, <em>given</em>, the other variable(s)
in the model. Specifically, the hypotheses for the two main effects are:</p>
<ul>
<li><p>Main effect test for A: </p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: No differences in means across levels of A in population,
given B in the model</p>
<p><span class="math inline">\(\Leftrightarrow\)</span> All <span class="math inline">\(\tau_j\text{&#39;s} = 0\)</span> in additive model.</p></li>
<li><p><span class="math inline">\(H_A\)</span>: Some difference in means across levels A in population,
given B in the model</p>
<p><span class="math inline">\(\Leftrightarrow\)</span> At least one <span class="math inline">\(\tau_j \ne 0\)</span>, in additive model.</p></li>
</ul></li>
<li><p>Main effect test for B:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: No differences in means across levels of B in population,
given A in the model</p>
<p><span class="math inline">\(\Leftrightarrow\)</span> All <span class="math inline">\(\gamma_k\text{&#39;s} = 0\)</span> in additive model.</p></li>
<li><p><span class="math inline">\(H_A\)</span>: Some difference in means across levels B in population,
given A in the model</p>
<p><span class="math inline">\(\Leftrightarrow\)</span> At least one <span class="math inline">\(\gamma_k \ne 0\)</span>, in additive model.</p></li>
</ul></li>
</ul>
<p>In order to test these effects (interaction in the interaction model and
main effects in the additive model), <span class="math inline">\(F\)</span>-tests are developed using Sums of
Squares, Mean Squares, and degrees of freedom similar to those in
Chapter <a href="chapter3.html#chapter3">3</a>.

We
won’t worry about the details of the sums of squares formulas but you should
remember the sums of squares decomposition, which still applies<a href="#fn84" class="footnote-ref" id="fnref84"><sup>84</sup></a>. 

Table <a href="chapter4.html#tab:Table4-1">4.1</a>
summarizes the ANOVA results you will obtain for the interaction
model and Table <a href="chapter4.html#tab:Table4-2">4.2</a> provides the similar general results for the additive
model. As we saw in Chapter <a href="chapter3.html#chapter3">3</a>, the degrees of freedom are the amount of
information that is free to vary at a particular level and that rule generally holds
here. For example, for factor A with <span class="math inline">\(J\)</span> levels, there are <span class="math inline">\(J-1\)</span> parameters that
are free since the baseline is fixed. The residual degrees of freedom for both
models are not as easily explained but have a simple formula. Note that the sum
of the degrees of freedom from the main effects, (interaction if present), and
error need to equal <span class="math inline">\(N-1\)</span>, just like in the One-Way ANOVA table.</p>

<table>
<caption><span id="tab:Table4-1">Table 4.1: </span> Interaction Model ANOVA Table.</caption>
<colgroup>
<col width="19%" />
<col width="20%" />
<col width="24%" />
<col width="17%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><strong>Source</strong>    </th>
<th align="left"><strong>DF</strong>     </th>
<th align="left"><strong>SS</strong></th>
<th align="left"><strong>MS</strong></th>
<th align="left"><strong>F-statistics</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left"><span class="math inline">\(J-1\)</span></td>
<td align="left"><span class="math inline">\(\text{SS}_A\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_A = \text{SS}_A/\text{df}_A\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_A/\text{MS}_E\)</span></td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left"><span class="math inline">\(K-1\)</span></td>
<td align="left"><span class="math inline">\(\text{SS}_B\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_B = \text{SS}_B/\text{df}_B\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_B/\text{MS}_E\)</span></td>
</tr>
<tr class="odd">
<td align="left">A:B (interaction)</td>
<td align="left"><span class="math inline">\((J-1)(K-1)\)</span></td>
<td align="left"><span class="math inline">\(\text{SS}_{AB}\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_{AB} = \text{SS}_{AB}/\text{df}_{AB}\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_{AB}/\text{MS}_E\)</span></td>
</tr>
<tr class="even">
<td align="left">Error</td>
<td align="left"><span class="math inline">\(N-JK\)</span></td>
<td align="left"><span class="math inline">\(\text{SS}_E\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_E = \text{SS}_E/\text{df}_E\)</span></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><b><font
color='red'>Total</font></b></td>
<td align="left"><span class="math inline">\(\color{red}{\mathbf{N-1}}\)</span></td>
<td align="left"><span class="math inline">\(\color{red}{\textbf{SS}_{\textbf{Total}}}\)</span></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>

<table>
<caption><span id="tab:Table4-2">Table 4.2: </span> Additive Model ANOVA Table.</caption>
<colgroup>
<col width="20%" />
<col width="22%" />
<col width="25%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><strong>Source</strong>    </th>
<th align="left"><strong>DF</strong>     </th>
<th align="left"><strong>SS</strong></th>
<th align="left"><strong>MS</strong></th>
<th align="left"><strong>F-statistics</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left"><span class="math inline">\(J-1\)</span></td>
<td align="left"><span class="math inline">\(\text{SS}_A\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_A = \text{SS}_A/\text{df}_A\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_A/\text{MS}_E\)</span></td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left"><span class="math inline">\(K-1\)</span></td>
<td align="left"><span class="math inline">\(\text{SS}_B\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_B = \text{SS}_B/\text{df}_B\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_B/\text{MS}_E\)</span></td>
</tr>
<tr class="odd">
<td align="left">Error</td>
<td align="left"><span class="math inline">\(N-J-K+1\)</span></td>
<td align="left"><span class="math inline">\(\text{SS}_E\)</span></td>
<td align="left"><span class="math inline">\(\text{MS}_E = \text{SS}_E/\text{df}_E\)</span></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><b><font
color='red'>Total</font></b></td>
<td align="left"><span class="math inline">\(\color{red}{\mathbf{N-1}}\)</span></td>
<td align="left"><span class="math inline">\(\color{red}{\textbf{SS}_{\textbf{Total}}}\)</span></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>The mean squares are formed by taking the sums of squares (we’ll let R find those
for us) and dividing by the <span class="math inline">\(df\)</span> in the row.

The <span class="math inline">\(F\)</span>-ratios are found by taking
the mean squares from the row and dividing by the mean squared error (<span class="math inline">\(\text{MS}_E\)</span>).
They follow <span class="math inline">\(F\)</span>-distributions with numerator degrees
of freedom from the row and denominator degrees of freedom from the Error row
(in R output this the <code>Residuals</code> row).


It is possible to develop permutation
tests for these methods but some
technical issues arise in doing permutation tests for interaction model components
so we will not use them here. This means we will have to place even more
emphasis on the data not presenting clear violations of assumptions since we only have the parametric method
available.

</p>
<p>With some basic expectations about the ANOVA tables and <span class="math inline">\(F\)</span>-statistic construction
in mind, we can get to actually estimating the models and exploring the results.

The first example involves the fake paper towel data
displayed in Figure <a href="chapter4.html#fig:Figure4-1">4.1</a> and <a href="chapter4.html#fig:Figure4-2">4.2</a>. It appeared
that Scenario 5 was the correct
story since the lines appeared to be non-parallel, but we need to know whether there is
sufficient evidence to suggest that the interaction is “real” and we get that through the
interaction hypothesis test. To fit the interaction model using <code>lm</code>,
the general formulation is <code>lm(y ~ x1 * x2, data = ...)</code>. The
order of the variables doesn’t matter as the most important part of the model,
to start with, relates to the interaction of the variables.
</p>
<p>The ANOVA table output
shows the results for the interaction model obtained by running the <code>anova</code>
function on the model called <code>m1</code>.

Specifically, the test that
<span class="math inline">\(H_0: \text{ All } \omega_{jk}\text{&#39;s} = 0\)</span> has a
test statistic of <span class="math inline">\(F(2,24) = 1.92\)</span> (in the output from the row with
brands:drops) and a p-value of 0.17. So there is weak evidence against the null hypothesis of no interaction, with a 17% chance we would
observe a difference in the <span class="math inline">\(\omega_{jk}\text{&#39;s}\)</span> like we did or more
extreme if the <span class="math inline">\(\omega_{jk}\text{&#39;s}\)</span> really were all 0. So we would conclude that the interaction is probably not needed<a href="#fn85" class="footnote-ref" id="fnref85"><sup>85</sup></a>. Note that for the interaction
model components, R presents them with a colon, <code>:</code>, between the variable
names.
</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="chapter4.html#cb340-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(responses <span class="sc">~</span> brand <span class="sc">*</span> drops, <span class="at">data =</span> pt)</span>
<span id="cb340-2"><a href="chapter4.html#cb340-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: responses
##             Df Sum Sq Mean Sq F value   Pr(&gt;F)
## brand        1 4.3322  4.3322 10.5192 0.003458
## drops        2 4.8581  2.4290  5.8981 0.008251
## brand:drops  2 1.5801  0.7901  1.9184 0.168695
## Residuals   24 9.8840  0.4118</code></pre>
<p>It is useful to display the estimates from this model and we can utilize
<code>plot(allEffects(MODELNAME))</code> to visualize the results for the terms
in our models. If we turn on the options for <code>grid = T</code>, <code>multiline = T</code>,
and <code>ci.style = "bars"</code> we get a useful version of the basic
“effect plot” for Two-Way ANOVA
models with interaction. I also added <code>lty = c(1:2)</code> to change the line type for the two lines (replace 2 with the number of levels in the variable driving the different lines. The results of the estimated interaction model are
displayed in Figure <a href="chapter4.html#fig:Figure4-7">4.7</a>, which looks very similar to our
previous interaction plot. The only difference is that this comes from model
that assumes equal variance and these plots show 95% confidence intervals
for the means instead of the <span class="math inline">\(\pm\)</span> 1 SE used in the <code>intplot</code> where each SE is calculated using the variance of the observations at each combination of levels. Note that other than the lines connecting the means, this plot also is similar to the pirate-plot in Figure <a href="chapter4.html#fig:Figure4-1">4.1</a> that also displayed the original responses for each of the six combinations of the two explanatory variables. That plot then provides a place to assess assumptions of the equal variance and distributions for each group as well as explore differences in the group means.
</p>

<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="chapter4.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb342-2"><a href="chapter4.html#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(m1), <span class="at">grid =</span> T, <span class="at">multiline =</span> T, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="at">ci.style =</span> <span class="st">&quot;bars&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-7"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-7-1.png" alt="Plot of estimated results of interaction model for the paper towel performance data." width="75%" />
<p class="caption">
Figure 4.7: Plot of estimated results of interaction model for the paper towel performance data.
</p>
</div>
<p>In the absence of sufficient evidence to include the
interaction, the model should be simplified to the additive model and the interpretation
focused on each main effect, conditional on having the other variable in the
model. To fit an additive model and not include an interaction, the model
formula involves a “+” instead of a “<code>*</code>” between the explanatory variables. </p>
<!-- \newpage -->
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="chapter4.html#cb343-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(responses <span class="sc">~</span> brand <span class="sc">+</span> drops, <span class="at">data =</span> pt)</span>
<span id="cb343-2"><a href="chapter4.html#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: responses
##           Df  Sum Sq Mean Sq F value   Pr(&gt;F)
## brand      1  4.3322  4.3322  9.8251 0.004236
## drops      2  4.8581  2.4290  5.5089 0.010123
## Residuals 26 11.4641  0.4409</code></pre>
<p>The p-values for the main effects of <code>brand</code> and <code>drops</code> change slightly from the
results in the interaction model due to changes in the <span class="math inline">\(\text{MS}_E\)</span> from
0.4118 to 0.4409 (more variability is left over in the simpler model) and the
<span class="math inline">\(\text{DF}_{\text{error}}\)</span> that increases from 24 to 26. In both models, the
<span class="math inline">\(\text{SS}_{\text{Total}}\)</span> is the same (20.6544). In the interaction model,</p>
<p><span class="math display">\[\begin{array}{rl}
\text{SS}_{\text{Total}} &amp; = \text{SS}_{\text{brand}} + \text{SS}_{\text{drops}}
+ \text{SS}_{\text{brand:drops}} + \text{SS}_{\text{E}}\\
&amp; = 4.3322 + 4.8581 + 1.5801 + 9.8840\\
&amp; = 20.6544.\\
\end{array}\]</span></p>
<p>In the additive model, the variability that was attributed to the interaction term
in the interaction model (<span class="math inline">\(\text{SS}_{\text{brand:drops}} = 1.5801\)</span>) is pushed into the
<span class="math inline">\(\text{SS}_{\text{E}}\)</span>, which increases from 9.884 to 11.4641. The sums of squares
decomposition in the additive model is</p>
<p><span class="math display">\[\begin{array}{rl}
\text{SS}_{\text{Total}} &amp; = \text{SS}_{\text{brand}} + \text{SS}_{\text{drops}}
 + \text{SS}_{\text{E}} \\
&amp; = 4.3322 + 4.8581 + 11.4641 \\
&amp; = 20.6544. \\
\end{array}\]</span></p>
<p>This shows that the sums of squares decomposition applies in these more complicated
models as it did in the One-Way ANOVA.

It also shows that if the interaction is
removed from the model, that variability is lumped in with the other
unexplained variability that goes in the <span class="math inline">\(\text{SS}_{\text{E}}\)</span> in any model.</p>
<p>The fact that the sums of squares decomposition can be applied here is
useful, except that there is a small issue
with the main effect tests in the ANOVA table results that follow this
decomposition when the design is not balanced. It ends up that the tests in a
typical ANOVA table are only conditional on the tests higher up in the table. For
example, in the additive model ANOVA table, the <code>Brand</code> test is not
conditional on the <code>Drops</code> effect, but the <code>Drops</code> effect is conditional on the
<code>Brand</code> effect. In balanced designs, conditioning on the other variable does not change the results but in unbalanced designs, the order does matter. To get both results to be similarly conditional on the other variable, we have to use another type of sums of
squares, called <strong><em>Type II sums of squares</em></strong>.

These sums of squares will no longer always
follow the rules of the sums of squares decomposition but they
will test the desired hypotheses. Specifically, they provide each test
conditional on any other terms at the same level of the model and match the
hypotheses written out earlier in this section. To get the “correct” ANOVA
results, the <code>car</code> package (<span class="citation"><a href="#ref-R-car" role="doc-biblioref">Fox, Weisberg, and Price</a> (<a href="#ref-R-car" role="doc-biblioref">2021</a>)</span>, <span class="citation"><a href="#ref-Fox2011" role="doc-biblioref">Fox and Weisberg</a> (<a href="#ref-Fox2011" role="doc-biblioref">2011</a>)</span>) is required. We use the
<code>Anova</code> function on our linear models from here forward to get the “right”
tests in our ANOVA tables<a href="#fn86" class="footnote-ref" id="fnref86"><sup>86</sup></a>.

Note how the case-sensitive nature of R code shows
up in the use of the capital “A” <code>Anova</code> function instead of the lower-case “a” <code>anova</code>
function used previously. In this situation, because the design was balanced, the
results are the same using either function. Observational studies rarely
generate balanced designs (some designed studies can result in unbalanced
designs too) so we will generally just use the Type II version of the sums of
squares to give us the desired results across different data sets we might analyze. The <code>Anova</code> results using the Type II sums of
squares are slightly more conservative than the results from <code>anova</code>,
which are called Type I sums of squares.

The sums of squares decomposition no
longer applies, but it is a small sacrifice to get each test after
adjusting for all other variables<a href="#fn87" class="footnote-ref" id="fnref87"><sup>87</sup></a>.
</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="chapter4.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb345-2"><a href="chapter4.html#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m2)</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: responses
##            Sum Sq Df F value   Pr(&gt;F)
## brand      4.3322  1  9.8251 0.004236
## drops      4.8581  2  5.5089 0.010123
## Residuals 11.4641 26</code></pre>
<p>The new output switches the columns around and doesn’t show you the mean squares,
but gives the most critical parts of the output. Here, there is no change in
results because it is a balanced design with equal counts of responses in each
combination of the two explanatory variables.</p>
<p>The additive model, when appropriate, provides simpler interpretations for
each explanatory variable compared to models
with interactions because the effect of one variable is the same regardless of
the levels of the other variable and vice versa.

There are two tools to aid in
understanding the impacts of the two variables in the additive model. First,
the model summary provides estimated coefficients with interpretations like
those seen in Chapter <a href="chapter3.html#chapter3">3</a> (deviation of group <span class="math inline">\(j\)</span> or <span class="math inline">\(k\)</span> from
the baseline group’s mean), except with the additional wording of
“controlling for” the other variable
added to any of the discussion. Second, the term-plots now show each main
effect and how the groups differ with one panel for each of the two explanatory
variables in the model. These term-plots are created by holding the other
variable constant at one of its levels (the most frequently occurring or first if the there are multiple groups tied for being most frequent) and presenting the estimated means across the levels of the variable in the plot.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="chapter4.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = responses ~ brand + drops, data = pt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4561 -0.4587  0.1297  0.4434  0.9695 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   1.8454     0.2425   7.611 4.45e-08
## brandB2       0.7600     0.2425   3.134  0.00424
## drops20      -0.4680     0.2970  -1.576  0.12715
## drops30      -0.9853     0.2970  -3.318  0.00269
## 
## Residual standard error: 0.664 on 26 degrees of freedom
## Multiple R-squared:  0.445,  Adjusted R-squared:  0.3809 
## F-statistic: 6.948 on 3 and 26 DF,  p-value: 0.001381</code></pre>
<p>In the model summary, the baseline combination estimated in the <code>(Intercept)</code>
row is for <code>Brand</code> <em>B1</em> and <code>Drops</code> 10 and estimates the mean failure
time as 1.85 seconds for this combination. As
before, the group labels that do not show up are the baseline but there are two
variables’ baselines to identify. Now the “simple” aspects of the additive
model show up. The interpretation of the <code>Brands</code> <em>B2</em> coefficient is as
a deviation from the baseline but it applies regardless of the level of
<code>Drops</code>. Any difference between <em>B1</em> and <em>B2</em> involves a shift up of 0.76 seconds
in the estimated mean failure time. Similarly, going from 10 (baseline) to 20
drops results in a drop in the estimated failure mean of 0.47 seconds and going
from 10 to 30 drops results in a drop of almost 1 second in the average time to
failure, both estimated changes are the same regardless of the brand of paper
towel being considered. Sometimes, especially in observational studies, we use
the terminology “controlled for” to remind the reader that the other variable
was present in the model<a href="#fn88" class="footnote-ref" id="fnref88"><sup>88</sup></a> and also explained some of the variability in the
responses. The term-plots for
the additive model (Figure <a href="chapter4.html#fig:Figure4-8">4.8</a>) help us visualize the
impacts of changes brand and changing water levels, holding the other
variable constant. The differences in heights in each panel correspond
to the coefficients just discussed.</p>

<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="chapter4.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb349-2"><a href="chapter4.html#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(m2))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-8"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-8-1.png" alt="Term-plots of additive model for paper towel data. Left panel displays results for two brands and right panel for number of drops of water, each after controlling for the other." width="75%" />
<p class="caption">
Figure 4.8: Term-plots of additive model for paper towel data. Left panel displays results for two brands and right panel for number of drops of water, each after controlling for the other.
</p>
</div>
<p>With the first additive model we have considered, it is now the first time where we are working with a model where we can’t display the observations together with the means that the model is producing because the results for each predictor are averaged across the levels of the other predictor. To visualize some aspects of the original observations with the estimates from each group, we can turn on an option in the term-plots (<code>residuals = T</code>) to obtain the <strong><em>partial residuals</em></strong>  that show the residuals as a function of one variable after adjusting for the effects/impacts of other variables. We will avoid the specifics of the calculations for now, but you can use these to explore the residuals at different levels of each predictor. They will be most useful in the Chapters <a href="chapter7.html#chapter7">7</a> and <a href="chapter8.html#chapter8">8</a> but give us some insights in unexplained variation in each level of the predictors once we remove the impacts of other predictors in the model. Use plots like Figure <a href="chapter4.html#fig:Figure4-9">4.9</a> to look for different variability at different levels of the predictors and locations of possible outliers in these models. Note that the points (open circles) are jittered to aid in seeing all of them, the means of each group of residuals are indicated by a filled large circle, and the smaller circles in the center of the bars for the 95% confidence intervals are the means from the model. Term-plots with partial residuals accompany our regular diagnostic plots for assessing equal variance assumptions in these models – in some cases adding the residuals will clutter the term-plots so much that reporting them is not useful since one of the main purposes of the term-plots is to visualize the model estimates. So use the <code>residuals = T</code> option judiciously.</p>

<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="chapter4.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb350-2"><a href="chapter4.html#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(m2, <span class="at">residuals =</span> T))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-9"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-9-1.png" alt="Term-plots of additive model for paper towel data with partial residuals added. Relatively similar variability seems to be present in each of the groups of residuals after adjusting for the other variable except for the residuals for the 10 drops where the variability is smaller, especially if one small outlier is ignored." width="75%" />
<p class="caption">
Figure 4.9: Term-plots of additive model for paper towel data with partial residuals added. Relatively similar variability seems to be present in each of the groups of residuals after adjusting for the other variable except for the residuals for the 10 drops where the variability is smaller, especially if one small outlier is ignored.
</p>
</div>
<p>For the One-Way and Two-Way interaction models, the partial residuals are just the original observations so present similar information as the pirate-plots but do show the model estimated 95% confidence intervals. With interaction models, you can use the default settings in <code>effects</code> when adding in the partial residuals as seen below in Figure <a href="chapter4.html#fig:Figure4-12">4.12</a>.</p>
<!-- \newpage -->
</div>
<div id="section4-4" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Guinea pig tooth growth analysis with Two-Way ANOVA</h2>
<p>The effects of dosage and delivery method of ascorbic acid on Guinea Pig
odontoblast growth was analyzed as a One-Way ANOVA in Section <a href="chapter3.html#section3-5">3.5</a>
by assessing evidence of any difference in the
means of any of the six combinations of dosage method (Vit C capsule vs Orange Juice) and
three dosage amounts (0.5, 1, and 2 mg/day). Now we will consider the dosage
and delivery methods as two separate variables and explore their potential
interaction. A pirate-plot and interaction plot are provided in
Figure <a href="chapter4.html#fig:Figure4-10">4.10</a>.</p>

<div class="figure" style="text-align: center"><span id="fig:Figure4-10"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-10-1.png" alt="Pirate-plot and interaction plot of the odontoblast growth data set." width="75%" />
<p class="caption">
Figure 4.10: Pirate-plot and interaction plot of the odontoblast growth data set.
</p>
</div>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="chapter4.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ToothGrowth)</span>
<span id="cb351-2"><a href="chapter4.html#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb351-3"><a href="chapter4.html#cb351-3" aria-hidden="true" tabindex="-1"></a>ToothGrowth <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ToothGrowth)</span></code></pre></div>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="chapter4.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb352-2"><a href="chapter4.html#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pirateplot</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dose, <span class="at">data =</span> ToothGrowth, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>),</span>
<span id="cb352-3"><a href="chapter4.html#cb352-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Pirate-plot&quot;</span>,  <span class="at">xlab =</span> <span class="st">&quot;Dosage&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Odontoblast Growth&quot;</span>,</span>
<span id="cb352-4"><a href="chapter4.html#cb352-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">inf.method =</span> <span class="st">&quot;ci&quot;</span>, <span class="at">inf.disp =</span> <span class="st">&quot;line&quot;</span>, <span class="at">theme =</span> <span class="dv">2</span>)</span>
<span id="cb352-5"><a href="chapter4.html#cb352-5" aria-hidden="true" tabindex="-1"></a><span class="fu">intplot</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dose, <span class="at">data =</span> ToothGrowth, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb352-6"><a href="chapter4.html#cb352-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Interaction Plot&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>))</span></code></pre></div>
<p>It appears that the effect of method changes based on the dosage as the
interaction plot seems to show some evidence of non-parallel lines.

Actually,
it appears that the effect of delivery method is the same (parallel lines) for doses 0.5 and 1.0
mg/day but that the effect of delivery method changes for 2 mg/day.</p>
<p>We can use the ANOVA <span class="math inline">\(F\)</span>-test for an interaction to assess whether we think the
interaction is “real” relative to the variability in the responses.

That is, is it larger than we would expect due to natural variation in the
data? If yes, then we think it is a real effect and we should account for it. The
following code fits the interaction model and provides an ANOVA table.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="chapter4.html#cb353-1" aria-hidden="true" tabindex="-1"></a>TG1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dose, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb353-2"><a href="chapter4.html#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(TG1)</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: len
##            Sum Sq Df  F value    Pr(&gt;F)
## supp       205.35  1  12.3170 0.0008936
## dose      2224.30  1 133.4151 &lt; 2.2e-16
## supp:dose   88.92  1   5.3335 0.0246314
## Residuals  933.63 56</code></pre>
<p>The R output is reporting an interaction test result of <span class="math inline">\(F(1,56) = 5.3\)</span> with
a p-value of 0.025. But this should raise a red flag since the numerator
degrees of freedom are not what we should expect based on Table <a href="chapter4.html#tab:Table4-1">4.1</a> of <span class="math inline">\((K-1)*(J-1) = (2-1)*(3-1) = 2\)</span>.

This brings up an issue in R when working
with categorical variables. If the levels of a categorical variable are entered
numerically, R will treat them as quantitative variables and not split out the
different levels of the categorical variable. To make sure that R treats
categorical variables the correct way, we should use the <code>factor</code>
function on any variables<a href="#fn89" class="footnote-ref" id="fnref89"><sup>89</sup></a> that are categorical in meaning but are coded numerically in the data set. The following code creates a new variable called <code>dosef</code>
using <code>mutate</code> and the <code>factor</code> function to help us obtain correct results from the linear
model.

The re-run of the ANOVA table provides the correct analysis and the
expected <span class="math inline">\(df\)</span> for the two rows of output involving <code>dosef</code>:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="chapter4.html#cb355-1" aria-hidden="true" tabindex="-1"></a>ToothGrowth <span class="ot">&lt;-</span> ToothGrowth <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dosef =</span> <span class="fu">factor</span>(dose))</span>
<span id="cb355-2"><a href="chapter4.html#cb355-2" aria-hidden="true" tabindex="-1"></a>TG2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dosef, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb355-3"><a href="chapter4.html#cb355-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(TG2)</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: len
##             Sum Sq Df F value    Pr(&gt;F)
## supp        205.35  1  15.572 0.0002312
## dosef      2426.43  2  92.000 &lt; 2.2e-16
## supp:dosef  108.32  2   4.107 0.0218603
## Residuals   712.11 54</code></pre>
<p>The ANOVA <span class="math inline">\(F\)</span>-test for an interaction between supplement type and dosage level is
<span class="math inline">\(F(2,54) = 4.107\)</span> with a p-value of 0.022. So there is moderate to strong evidence against the null hypothesis of no interaction between <em>Dosage</em> and <em>Delivery method</em>, so we would likely conclude that there is an interaction present that we should discuss and this supports a changing effect on odontoblast growth of dosage based on the delivery
method in these guinea pigs.</p>
<p>Any similarities between this correct
result and the previous WRONG result are coincidence. I once
attended a Master’s thesis defense where the results from a similar model were not as
expected (small p-values in places they didn’t expect and large p-values in
places where they thought differences existed based on past results and plots of the data). During the presentation, the student
showed some ANOVA tables and the four level categorical variable had 1 numerator
<span class="math inline">\(df\)</span> in all ANOVA tables. The student
passed with <em>major</em> revisions but had to re-run <strong>all</strong> the results and re-write
<strong>all</strong> the conclusions…

So be careful to check the ANOVA results (<span class="math inline">\(df\)</span>
and for the right number of expected model coefficients) to make
sure they match your expectations. This is one reason why you will be learning
to fill in ANOVA tables based on information about the study so that you can be
prepared to detect when your code has let you down<a href="#fn90" class="footnote-ref" id="fnref90"><sup>90</sup></a>. It
is also a great reason to explore term-plots and coefficient interpretations as
that can also help diagnose errors in model construction.</p>
<p>Getting back to the previous results, we now have enough background information
to more formally write up a
focused interpretation of these results. The 6+ hypothesis testing steps in
this situation would be focused on first identifying that the best analysis
here is as a Two-Way ANOVA situation (these data were analyzed in
Chapter <a href="chapter3.html#chapter3">3</a> as
a One-Way ANOVA but this version is likely better because it can explore whether there
is an interaction between delivery method and dosage).

We will focus on assessing the interaction. If
the interaction had been dropped, we would have reported the test results for the
interaction, then re-fit the additive model and used it to explore the main effect
tests and estimates for <em>Dose</em> and <em>Delivery method</em>. But since we are inclined to retain the interaction component in the model, the steps focus on the interaction.</p>
<!-- \newpage -->
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="chapter4.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb357-2"><a href="chapter4.html#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(TG2, <span class="at">pch =</span> <span class="dv">16</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-11"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-11-1.png" alt="Diagnostic plots for the interaction model for odontoblast growth interaction model." width="75%" />
<p class="caption">
Figure 4.11: Diagnostic plots for the interaction model for odontoblast growth interaction model.
</p>
</div>
<ol start="0" style="list-style-type: decimal">
<li><p>The RQ is whether there is an interaction of dosage and delivery method on odontoblast growth. Data were collected at all combinations of these predictor variables on the size of the cells, so they can address the size of the cells in these condition combinations. The interaction <span class="math inline">\(F\)</span>-test will be used to assess the research question.</p></li>
<li><p><strong>Hypotheses:</strong></p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: No interaction between <em>Delivery method</em> and <em>Dose</em> on odontoblast
growth in population of guinea pigs</p>
<p><span class="math inline">\(\Leftrightarrow\)</span> All <span class="math inline">\(\omega_{jk}\text{&#39;s} = 0\)</span>.</p></li>
<li><p><span class="math inline">\(H_A\)</span>: Interaction between <em>Delivery method</em> and <em>Dose</em> on odontoblast
growth in population of guinea pigs</p>
<p><span class="math inline">\(\Leftrightarrow\)</span> At least one <span class="math inline">\(\omega_{jk}\ne 0\)</span>.</p></li>
</ul></li>
<li><p><strong>Plot the data and assess validity conditions:</strong>
</p>
<ul>
<li><p>Independence: </p>
<ul>
<li>There is no indication of an issue with this assumption because we
don’t know of a reason why the independence of the measurements of odontoblast growth of
across the guinea pigs as studied might be violated.</li>
</ul></li>
<li><p>Constant variance:</p>
<ul>
<li><p>To assess this assumption, we can use the pirate-plot in
Figure <a href="chapter4.html#fig:Figure4-10">4.10</a>, the diagnostic plots in
Figure <a href="chapter4.html#fig:Figure4-11">4.11</a>, and by adding the partial residuals to
the term-plot<a href="#fn91" class="footnote-ref" id="fnref91"><sup>91</sup></a> as shown in <a href="chapter4.html#fig:Figure4-12">4.12</a>.</p></li>
<li><p>In the Residuals vs Fitted and the Scale-Location plots, the
differences in variability among the groups (see the different
x-axis positions for each group’s fitted values) is minor, so
there is not strong evidence of a problem with the equal variance
assumption. Similarly, the original pirate-plots and adding the partial
residuals to the term-plot do not highlight big differences in
variability at any of the combinations of the predictors, so do not
suggest clear issues with this assumption.
 </p></li>
</ul>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="chapter4.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(TG2, <span class="at">residuals =</span> T, <span class="at">x.var =</span> <span class="st">&quot;dosef&quot;</span>)) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-12"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-12-1.png" alt="Term-plot for odontoblast growth interaction model with partial residuals added." width="75%" />
<p class="caption">
Figure 4.12: Term-plot for odontoblast growth interaction model with partial residuals added.
</p>
</div></li>
<li><p>Normality of residuals:</p>
<ul>
<li>The QQ-Plot in Figure <a href="chapter4.html#fig:Figure4-11">4.11</a> does not suggest a
problem with this assumption. </li>
</ul></li>
</ul></li>
</ol>
<p>Note that these diagnostics and conclusions are the same as in Section <a href="chapter3.html#section3-5">3.5</a>
because the interaction model and the One-Way ANOVA model with all six combinations
of the levels of the two variables fit exactly the same. But the RQ that we can
address differs due to the different model parameterizations.</p>
<ol start="3" style="list-style-type: decimal">
<li><p><strong>Calculate the test statistic and p-value for the interaction test.</strong></p>
<p></p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="chapter4.html#cb359-1" aria-hidden="true" tabindex="-1"></a>TG2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dosef, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb359-2"><a href="chapter4.html#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(TG2) </span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: len
##             Sum Sq Df F value    Pr(&gt;F)
## supp        205.35  1  15.572 0.0002312
## dosef      2426.43  2  92.000 &lt; 2.2e-16
## supp:dosef  108.32  2   4.107 0.0218603
## Residuals   712.11 54</code></pre>
<ul>
<li><p>The test statistic is <span class="math inline">\(F(2,54) = 4.107\)</span> with a p-value of 0.0219</p></li>
<li><p>To find this p-value directly in R from the test statistic value and
<span class="math inline">\(F\)</span>-distribution, we can use the <code>pf</code> function.
</p></li>
</ul>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="chapter4.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="fl">4.107</span>, <span class="at">df1 =</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="dv">54</span>, <span class="at">lower.tail =</span> F)</span></code></pre></div>
<pre><code>## [1] 0.0218601</code></pre></li>
</ol>
<div style="page-break-after: always;"></div>
<ol start="4" style="list-style-type: decimal">
<li><p><strong>Conclusion based on p-value:</strong></p>
<ul>
<li>With a p-value of 0.0219 (from <span class="math inline">\(F(2,54) = 4.107\)</span>), there is about a 2.19%
chance we would observe an interaction like
we did (or more extreme) if none were truly present. This provides moderate to strong
evidence against the null hypothesis of no interaction between delivery
method and dosage on odontoblast growth in the population so we would
conclude that there is likely an interaction and would retain the interaction in the model.</li>
</ul></li>
<li><p><strong>Size of differences:</strong></p>
<ul>
<li>See discussion below.</li>
</ul></li>
<li><p><strong>Scope of Inference:</strong></p>
<ul>
<li>Based on the random assignment of treatment levels, causal inference
is possible (the changes due to dosage in the differences based on
supplement type caused the differences in growth) but because the guinea
pigs were not randomly selected, the inferences only pertain to these guinea pigs.</li>
</ul></li>
</ol>
<p>In a Two-Way ANOVA, we need to go a little further to get to the final “size” interpretations since the models are more complicated. When there is an
interaction present, we should focus on the term-plot of
the interaction model for an interpretation of the form and pattern of the
interaction.

If the interaction were unimportant, then the hypotheses and
results should focus on the additive model results, especially the estimated
model coefficients. To see why we don’t usually discuss all the estimated
model coefficients in an interaction model, the six coefficients for this model are
provided:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="chapter4.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(TG2)<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##               Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept)      13.23   1.148353 11.5208468 3.602548e-16
## suppVC           -5.25   1.624017 -3.2327258 2.092470e-03
## dosef1            9.47   1.624017  5.8312215 3.175641e-07
## dosef2           12.83   1.624017  7.9001660 1.429712e-10
## suppVC:dosef1    -0.68   2.296706 -0.2960762 7.683076e-01
## suppVC:dosef2     5.33   2.296706  2.3207148 2.410826e-02</code></pre>
<p>There are two <span class="math inline">\(\widehat{\omega}_{jk}\text{&#39;s}\)</span> in the results, related to modifying the
estimates for doses of 1 (-0.68) and 2
(5.33) for the Vitamin C group. If you want to re-construct the fitted values
from the model that are displayed in Figure <a href="chapter4.html#fig:Figure4-13">4.13</a>, you have
to look for any
coefficients that are “turned on” for a combination of levels of interest. For
example, for the OJ group (solid line), the
dosage of 0.5 mg/day
has an estimate of an average growth of approximately 13 mm. This is the
baseline group, so the model estimate for an observation in the OJ and 0.5 mg/day
dosage is simply <span class="math inline">\(\widehat{y}_{i,\text{OJ},0.5mg} = \widehat{\alpha} = 13.23\)</span> microns.
For the OJ and 2 mg/day dosage estimate that has a value over 25 microns in the
plot, the model incorporates the deviation for the 2 mg/day dosage:
<span class="math inline">\(\widehat{y}_{i,\text{OJ},2mg} = \widehat{\alpha} + \widehat{\tau}_{2mg} = 13.23 + 12.83 = 26.06\)</span>
microns. For the Vitamin C group, another coefficient becomes involved from its “main
effect.” For the VC and 0.5 mg dosage level, the estimate is approximately 8 microns.
The pertinent model components are
<span class="math inline">\(\widehat{y}_{i,\text{VC},0.5mg} = \widehat{\alpha} + \widehat{\gamma}_{\text{VC}} = 13.23 + (-5.25) = 7.98\)</span>
microns. Finally, when we consider non-baseline results for both groups, three
coefficients are required to reconstruct the results in the plot. For example,
the estimate for the VC, 1 mg dosage is
<span class="math inline">\(\widehat{y}_{i,\text{VC},1mg} = \widehat{\alpha} + \widehat{\tau}_{1mg} + \widehat{\gamma}_{\text{VC}} + \widehat{\omega}_{\text{VC},1mg} = 13.23 + 9.47 + (-5.25) +(-0.68) = 16.77\)</span> microns. We usually will by-pass all this
fun(!) with the coefficients in an interaction model and go from the ANOVA
interaction test to focusing on the pattern of the responses in the interaction
plot or going to the simpler additive model, but it is good to know that there are still model coefficients driving
our results even if there are too many to be easily interpreted.</p>

<div class="figure" style="text-align: center"><span id="fig:Figure4-13"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-13-1.png" alt="Term-plot for the estimated interaction for the Odontoblast Growth data using the multiline = T and ci.style = "bars" options." width="75%" />
<p class="caption">
Figure 4.13: Term-plot for the estimated interaction for the Odontoblast Growth data using the <code>multiline = T</code> and <code>ci.style = "bars"</code> options.
</p>
</div>

<div class="figure" style="text-align: center"><span id="fig:Figure4-14"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-14-1.png" alt="Interaction plot for Odontoblast data with added CLD from Tukey’s HSD." width="75%" />
<p class="caption">
Figure 4.14: Interaction plot for Odontoblast data with added CLD from Tukey’s HSD.
</p>
</div>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="chapter4.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(TG2), <span class="at">grid =</span> T, <span class="at">multiline =</span> T, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="at">ci.style =</span> <span class="st">&quot;bars&quot;</span>)</span></code></pre></div>
<p>Given the presence of an important
interaction, then the final step in the interpretation here is to interpret the
results in the interaction plot or term-plot of the interaction model,
supported by the p-value suggesting a different effect of
supplement type based on the dosage level. To supplement this even more,
knowing which combinations of levels differ can enhance our discussion. Tukey’s
HSD results (specifically the CLD) can be added to the original interaction
plot by turning on the <code>cld = T</code> option in the <code>intplot</code> function as seen in
Figure <a href="chapter4.html#fig:Figure4-14">4.14</a>. Sometimes it is hard to see the letters and so
there is also a <code>cldshift = ...</code> option to move the letters up or down; here a
value of 1 seemed to work.  

</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="chapter4.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intplot</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dose, <span class="at">data =</span> ToothGrowth, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cldshift =</span> <span class="dv">1</span>,</span>
<span id="cb366-2"><a href="chapter4.html#cb366-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">cld =</span> T, <span class="at">main =</span> <span class="st">&quot;Interaction Plot with CLD&quot;</span>)</span></code></pre></div>
<p>The “size” interpretation of the previous hypothesis test result could be something like the following: Generally increasing the dosage increases the mean growth except for
the 2 mg/day dosage level where the increase levels off in the OJ group (OJ 1
and 2 mg/day are not detectably different) and the differences between the two
delivery methods disappear at the highest dosage level. But for 0.5 and 1 mg/day
dosages, OJ is clearly better than VC by about 10 microns of growth on average.</p>
</div>
<div id="section4-5" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Observational study example: The Psychology of Debt</h2>
<p>In this section, the analysis of a survey of <span class="math inline">\(N = 464\)</span> randomly sampled
adults will be analyzed from a survey conducted by <span class="citation"><a href="#ref-Lea1995" role="doc-biblioref">Lea, Webley, and Walker</a> (<a href="#ref-Lea1995" role="doc-biblioref">1995</a>)</span>
and available in the <code>debt</code> data set from the <code>faraway</code> package
<span class="citation">(<a href="#ref-R-faraway" role="doc-biblioref">Faraway 2016</a>)</span>.

The subjects responded to a variety of questions
including whether they buy cigarettes (<code>cigbuy</code>: 0 if
no, 1 if yes), their housing situation (<code>house</code>: 1 = rent, 2 = mortgage,
and 3 = owned outright), their income group (<code>incomegp</code>: 1 =
lowest, 5 = highest), and their score on a continuous scale of attitudes about
debt (<code>prodebt</code>: 1 = least favorable, 6 = most favorable). The variable <code>prodebt</code>
was derived as the average of a series of questions about debt with each
question measured on an <strong><em>ordinal</em></strong> 1 to 6 scale, with higher values
corresponding to more positive responses about <span class="math inline">\(\underline{\text{going into debt}}\)</span>
of various kinds. The ordered scale on surveys that try to elicit your opinions on
topics with scales from 1 to 5, 1 to 6, 1 to 7 or even, sometimes, 1 to 10 is called
a <strong><em>Likert scale</em></strong> <span class="citation">(<a href="#ref-Likert1932" role="doc-biblioref">Likert 1932</a>)</span>.   It is not a quantitative scale and really
should be handled more carefully than taking an average of a set responses as was done here. That
said, it is extremely common practice in social science research to treat ordinal
responses as if they are quantitative and take the average of many of them to
create a more continuous response variable like the one we are using here. If
you continue your statistics explorations, you will see some better techniques
for analyzing ordinal responses. That said, the scale of the
response is relatively easy to understand as an amount of willingness to go
into debt on a scale from 1 to 6 with higher values corresponding to more
willingness to be in debt.</p>
<p>These data are typical of survey data where respondents were not required
to answer all questions and there are some
missing responses. We could clean out any individuals that failed to respond to
all questions (called “complete cases”) using the <code>drop_na</code> function,  which will return responses only for subjects
that responded to every question in
the data set, <code>debt</code>. The change in sample size is available by running the <code>dim</code>  function on the two data sets – there were <span class="math inline">\(464\)</span> observations (rows) initially along with <span class="math inline">\(13\)</span> variables (columns) and once observations with any missing values were dropped there are <span class="math inline">\(N = 304\)</span> for us to analyze. Losing 35% of the observations is a pretty noticeable loss.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="chapter4.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faraway)</span>
<span id="cb367-2"><a href="chapter4.html#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(debt)</span>
<span id="cb367-3"><a href="chapter4.html#cb367-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb367-4"><a href="chapter4.html#cb367-4" aria-hidden="true" tabindex="-1"></a>debt <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(debt) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">incomegp =</span> <span class="fu">factor</span>(incomegp),</span>
<span id="cb367-5"><a href="chapter4.html#cb367-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">cigbuy =</span> <span class="fu">factor</span>(cigbuy)</span>
<span id="cb367-6"><a href="chapter4.html#cb367-6" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb367-7"><a href="chapter4.html#cb367-7" aria-hidden="true" tabindex="-1"></a>debtc <span class="ot">&lt;-</span> debt <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span>
<span id="cb367-8"><a href="chapter4.html#cb367-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-9"><a href="chapter4.html#cb367-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(debt)</span></code></pre></div>
<pre><code>## [1] 464  13</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="chapter4.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(debtc)</span></code></pre></div>
<pre><code>## [1] 304  13</code></pre>
<p>Using <code>drop_na()</code> with a list a variable names, we can focus on the three variables we are using in this model and whether the responses are missing on them, only cleaning out rows that are missing on <code>incomegp</code>, <code>cigbuy</code>, and/or <code>prodebt</code><a href="#fn92" class="footnote-ref" id="fnref92"><sup>92</sup></a>. The missingness is less dramatic, retaining <span class="math inline">\(N = 388\)</span> observations in <code>debtRc</code> for our analysis using these three variables.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="chapter4.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values based on just three variables.</span></span>
<span id="cb371-2"><a href="chapter4.html#cb371-2" aria-hidden="true" tabindex="-1"></a>debtRc <span class="ot">&lt;-</span> debt <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(incomegp, cigbuy, prodebt)</span>
<span id="cb371-3"><a href="chapter4.html#cb371-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(debtRc)</span></code></pre></div>
<pre><code>## [1] 388  13</code></pre>
<p>The second approach seems better as it drops fewer observations so we will use that below. But suppose that people did not want to
provide their income levels if they were in the lowest or highest
income groups and that is why they are missing. Then we would be missing responses systematically and conclusions
could be biased because of ignoring particular types of subjects. We don’t have particular statistical tools to easily handle this problem but every researcher should worry about non-response when selected subjects do not respond at
all or fail to answer some questions. When the missing values are systematic in some fashion and not just missing randomly (missing randomly might be thought of as caused by “demonic intrusion” <span class="citation">(<a href="#ref-Hurlbert1984" role="doc-biblioref">Hurlbert 1984</a>)</span> that can’t be easily explained or related to the types of responses), then we worry about <strong><em>non-response bias</em></strong> that is systematically biasing our results because of the missing responses.   This also ties back into our discussion of who was sampled. We need to
think carefully about who was part of the sample but refused to participate and
how that might impact our inferences. And whether we can even address the research question of interest based on what was measured given those that refused/failed to respond. For example, suppose we are studying river flows and are interested in the height of a river. Missingness in these responses could arise because a battery fails or the data logger “crashes” (not related to the responses and so not definitely problematic) or because of something about the measurements to be taken that causes the missingness (suppose the gage can only can measure between one and three feet deep and the river is running at four feet deep during a flood or below 1 foot during a drought). The first machine failures are very different from the height-based missing responses; the height-based missingness clearly leads to bias in estimating mean river height because of what can not be observed. In Chapter <a href="chapter5.html#chapter5">5</a>, we introduce the <code>tableplot</code> as another tool to visualize data that can also show missing data patterns to help you think about these sorts of issues further<a href="#fn93" class="footnote-ref" id="fnref93"><sup>93</sup></a>. If you delete observations and the missing data are not random/non-systematic, your scope of inference is restricted to just those subjects that provided responses and were analyzed. If the missingness is random and not related to aspects of the measurements taken, then some missingness can be tolerated and still retain some comfort that inferences can be extended to the population a random sample of subjects was taken from.</p>
<p>Ignoring this potential for bias in the
results for the moment, we are first interested in whether buying
cigarettes/not and income groups interact in their explanation of the
respondent’s mean opinions on being in debt. The interaction plot
(Figure <a href="chapter4.html#fig:Figure4-15">4.15</a>) may suggest an interaction between <code>cigbuy</code>
and <code>incomegp</code> where the lines cross, switching which of the <code>cigbuy</code> levels is higher (income levels 2, 3, and 5) or even almost not different (income levels 1 and 4). But it is
not as clear as the previous examples, especially with how large the SEs are relative the variation in the means. The interaction <span class="math inline">\(F\)</span>-test helps us
objectively assess evidence against the null hypothesis of no interaction. Based on the plot, there do
not appear to be differences based on cigarette purchasing but there might be some
differences between the income groups if we drop the interaction from the model. If we drop the interaction, then
this suggests that we might be in Scenario 2 or 3 where a single main effect of
interest is present.</p>

<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="chapter4.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intplotarray</span>(prodebt <span class="sc">~</span> cigbuy <span class="sc">*</span> incomegp, <span class="at">data =</span> debtRc, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-15"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-15-1.png" alt="Interaction plot array of prodebt by income group (1 to 5) and whether they buy cigarettes (0 = no, 1 = yes)." width="75%" />
<p class="caption">
Figure 4.15: Interaction plot array of <code>prodebt</code> by income group (1 to 5) and whether they buy cigarettes (0 = no, 1 = yes).
</p>
</div>
<p>As in other situations, and especially
with observational studies where a single large sample is collected and then the levels of the factor variables are observed, it is
important to check for balance – whether all the combinations of the two
predictor variables are similarly represented.

Even more critically, we need to
check whether all the combinations of levels of factors are measured. If a
combination is not measured, then we lose the ability to estimate the mean for
that combination and the ability to test for an interaction. A solution to that
problem would be to collapse the categories of one of the variables, changing
the definitions of the levels but if you fail to obtain information for all
combinations, you can’t work with the interaction model. In this situation, we
barely have enough information to proceed (the smallest <span class="math inline">\(n_{jk}\)</span> is 13 for
income group 4 that buys cigarettes). We have a very unbalanced design
with counts between 13 and 60 in the different combinations, so lose some resistance to violation of assumptions but can proceed to explore the model with a critical eye on how the diagnostic plots look.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="chapter4.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(cigbuy <span class="sc">~</span> incomegp, <span class="at">data =</span> debtRc)</span></code></pre></div>
<pre><code>##       incomegp
## cigbuy  1  2  3  4  5
##      0 36 49 54 53 60
##      1 37 45 20 13 21</code></pre>
<p>The test for the interaction is always
how we start our modeling in Two-Way ANOVA situations. The ANOVA table suggests
that there is little evidence against the null hypothesis of no interaction between the income level and
buying cigarettes on the opinions of the respondents towards debt
(<span class="math inline">\(F(4,378) = 0.686\)</span>, p-value = 0.6022), so we would conclude that there is likely not an interaction present here and we can drop the interaction from the model. This suggests that the initial assessment
that the interaction wasn’t too prominent
was correct. We should move to the additive model here but first need to check
the assumptions to make sure we can trust this initial test.
</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="chapter4.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb376-2"><a href="chapter4.html#cb376-2" aria-hidden="true" tabindex="-1"></a>debt1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(prodebt <span class="sc">~</span> incomegp <span class="sc">*</span> cigbuy, <span class="at">data =</span> debtRc)</span>
<span id="cb376-3"><a href="chapter4.html#cb376-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(debt1)</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: prodebt
##                  Sum Sq  Df F value    Pr(&gt;F)
## incomegp         10.742   4  5.5246 0.0002482
## cigbuy            0.010   1  0.0201 0.8874246
## incomegp:cigbuy   1.333   4  0.6857 0.6022065
## Residuals       183.746 378</code></pre>

<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="chapter4.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb378-2"><a href="chapter4.html#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(debt1, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-16"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-16-1.png" alt="Diagnostic plot for prodebt by income group and buy cigarettes/not interaction model." width="75%" />
<p class="caption">
Figure 4.16: Diagnostic plot for <code>prodebt</code> by income group and buy cigarettes/not interaction model.
</p>
</div>
<p>The diagnostic plots (Figure <a href="chapter4.html#fig:Figure4-16">4.16</a>) seem to be pretty
well-behaved with no apparent
violations of the normality assumption and no clear evidence of a violation of
the constant variance assumption. There is no indication of a problem with the independence
assumption because there is no indication of structure to the measurements of the survey
respondents that might create dependencies. In observational studies, violations
of the independence assumption might come from repeated measures of the same
person over time or multiple measurements within the same family/household or samples
that are clustered geographically, none of which are part of the survey information we have.

The random sampling from a population should
allow inferences to a larger population except for that issue of removing
partially missing responses so we can’t safely generalize results beyond the complete observations we are using without worry that the missing subjects are systematically different from those we are able to analyze.

We also don’t have much information on the exact
population sampled, so will just leave this vague here but know that there would be a
population these conclusions apply since it was random sample (at least those that would answer the questions). All of this
suggests proceeding to fitting and exploring the additive model is reasonable
here. No causal inferences are possible because this is an observational study.</p>
<ol start="0" style="list-style-type: decimal">
<li><p>After ruling out the interaction of income and cigarette status on opinions about debt, we can focus on the additive model.</p></li>
<li><p><strong>Hypotheses (Two sets apply when the additive model is the focus!):</strong></p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: No difference in means for <code>prodebt</code> for income groups in
population, given cigarette buying in model</p>
<p><span class="math inline">\(\Leftrightarrow\)</span> All <span class="math inline">\(\tau_j\text{&#39;s} = 0\)</span> in additive model.</p></li>
<li><p><span class="math inline">\(H_A\)</span>: Some difference in means for <code>prodebt</code> for income group in
population, given cigarette buying in model</p>
<p><span class="math inline">\(\Leftrightarrow\)</span> Not all <span class="math inline">\(\tau_j\text{&#39;s} = 0\)</span> in additive model.</p></li>
<li><p><span class="math inline">\(H_0\)</span>: No difference in means for <code>prodebt</code> for cigarette
buying/not in population, given income group in model </span></p>
<p><span class="math inline">\(\Leftrightarrow\)</span> All <span class="math inline">\(\gamma_k\text{&#39;s} = 0\)</span> in additive model.</p></li>
<li><p><span class="math inline">\(H_A\)</span>: Some difference in means for <code>prodebt</code> for cigarette
buying/not in population, given income group in model</p>
<p><span class="math inline">\(\Leftrightarrow\)</span> Not all <span class="math inline">\(\gamma_k\text{&#39;s} = 0\)</span> in additive model.</p></li>
</ul></li>
<li><p><strong>Validity conditions – discussed above but with new plots for the additive model:</strong>
</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="chapter4.html#cb379-1" aria-hidden="true" tabindex="-1"></a>debt1r <span class="ot">&lt;-</span> <span class="fu">lm</span>(prodebt <span class="sc">~</span> incomegp <span class="sc">+</span> cigbuy, <span class="at">data =</span> debtRc)</span>
<span id="cb379-2"><a href="chapter4.html#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb379-3"><a href="chapter4.html#cb379-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(debt1r, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-17"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-17-1.png" alt="Diagnostic plot of additive model for ``prodebt`` by income group and whether they buy cigarettes/not." width="75%" />
<p class="caption">
Figure 4.17: Diagnostic plot of additive model for <code>prodebt</code> by income group and whether they buy cigarettes/not.
</p>
</div>
<ul>
<li><p>Constant Variance:</p>
<ul>
<li><p>In the Residuals vs Fitted and the Scale-Location plots in
Figure <a href="chapter4.html#fig:Figure4-17">4.17</a>, the differences in variability among
groups is minor and nothing suggests a violation. <strong>If you change
models, you should always revisit the diagnostic plots to make sure you
didn’t create problems that were not present in more complicated models.</strong>
 </p></li>
<li><p>We can also explore the partial residuals here as provided in
Figure <a href="chapter4.html#fig:Figure4-18">4.18</a>. The variability in the partial residuals
appears to be similar across the different levels of each predictor,
controlled for the other variable, and so does suggest any issues that
were missed by just looking at the overall residuals versus fitted
values in our regular diagnostic plots. Note how hard it is to see
differences in the mean for levels of <code>cigbuy</code> in this plot relative
to the variability in the partial residuals but that the differences in
the means in <code>incomegp</code> are at least somewhat obvious.</p></li>
</ul>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="chapter4.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(debt1r, <span class="at">residuals =</span> T))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-18"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-18-1.png" alt="Term-plot for additive model for ``prodebt`` by income group and whether they buy cigarettes/not with partial residuals." width="75%" />
<p class="caption">
Figure 4.18: Term-plot for additive model for <code>prodebt</code> by income group and whether they buy cigarettes/not with partial residuals.
</p>
</div></li>
<li><p>Normality of residuals:</p>
<ul>
<li>The QQ-Plot in Figure <a href="chapter4.html#fig:Figure4-17">4.17</a> does not suggest
a problem with this assumption. </li>
</ul></li>
</ul>
<p><!-- \newpage --></p></li>
<li><p><strong>Calculate the test statistics and p-values for the two main effect tests.</strong></p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="chapter4.html#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(debt1r)</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: prodebt
##            Sum Sq  Df F value    Pr(&gt;F)
## incomegp   10.742   4  5.5428 0.0002399
## cigbuy      0.010   1  0.0201 0.8872394
## Residuals 185.079 382</code></pre>
<ul>
<li>The test statistics are <span class="math inline">\(F(4,382) = 5.54\)</span> and <span class="math inline">\(F(1,382) = 0.0201\)</span> with p-values of 0.00024 and 0.887.</li>
</ul></li>
<li><p><strong>Conclusions (including for the initial work with the interaction test):</strong></p>
<ul>
<li>There was initially little to no evidence against the null hypothesis of no interaction
between income group and cigarette buying on pro-debt feelings
(<span class="math inline">\(F(4,378) = 0.686\)</span>, p-value = <span class="math inline">\(0.6022\)</span>) so we would conclude that there is likely
not an interaction in the population and the interaction was dropped
from the model. There is strong evidence against the null hypothesis of no
difference in the mean pro-debt feelings in the population across the income groups, after
adjusting for cigarette buying (<span class="math inline">\(F(4,382) = 5.54\)</span>, p-value = <span class="math inline">\(0.00024\)</span>), so we
would conclude that there is some difference in them. There is little evidence
against the null hypothesis of no difference in the mean pro-debt feelings in
the population based on cigarette buying/not, after adjusting for income
group (<span class="math inline">\(F(1,382) = 0.0201\)</span>, p-value = <span class="math inline">\(0.887\)</span>), so we would conclude that there
is probably not a difference across cigarette buying/not and could consider
dropping this term from the model.</li>
</ul></li>
</ol>
<p>So we learned that the additive model
was more appropriate for these responses and that the results resemble Scenario
2 or 3 with only one main effect being important. In the additive model, the
coefficients can be interpreted as shifts from the baseline after controlling
for the other variable in the model.</p>
<!-- \newpage -->
<ol start="5" style="list-style-type: decimal">
<li><p><strong>Size:</strong></p>
<ul>
<li>Figure <a href="chapter4.html#fig:Figure4-19">4.19</a> shows the increasing average comfort with being in
debt as the income groups go up except between groups 1 and 2 where 1 is a little
higher than two. Being a cigarette buyer was related to a lower comfort level
with debt but is really no different from those that did not report buying
cigarettes. It would be possible to consider follow-up tests akin to the Tukey’s
HSD comparisons for the levels of <code>incomegp</code> here but that is a bit beyond the
scope of this course – focus on the estimated mean for the 5<sup>th</sup> income group
being over 3.5 and none of the others over 3.2. That seems like an interesting
although modest difference in mean responses across income groups after
controlling for cigarette purchasing or not.</li>
</ul>

<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="chapter4.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(debt1r))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-19"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-19-1.png" alt="Term-plots for the prodebt response additive model with left panel for income group and the right panel for buying cigarettes or not (0 for no, 1 for yes)." width="75%" />
<p class="caption">
Figure 4.19: Term-plots for the <code>prodebt</code> response additive model with left panel for income group and the right panel for buying cigarettes or not (0 for no, 1 for yes).
</p>
</div></li>
<li><p><strong>Scope of inference:</strong></p>
<ul>
<li>Because the income group and cigarette purchasing were not (and really
could not) be randomly assigned, causal inference is not possible here. The
data set came from a random sample but from an unspecified population and
then there were missing observations. At best we can make inferences to
those in that population that would answer these questions and it would be
nice to know more about the population to really understand who this
actually applies to. There would certainly be concerns about non-response
bias in doing inference to the entire population that these data were
sampled from.</li>
</ul></li>
</ol>
<!-- \newpage -->
<p>The estimated coefficients can also be interesting to interpret for the
additive model. Here are the model summary coefficients:</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="chapter4.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(debt1r)<span class="sc">$</span>coefficients</span></code></pre></div>
<!-- \newpage -->
<pre><code>##                Estimate Std. Error    t value      Pr(&gt;|t|)
## (Intercept)  3.13127172 0.09027437 34.6861672 4.283917e-120
## incomegp2   -0.05371924 0.10860898 -0.4946114  6.211588e-01
## incomegp3    0.02680595 0.11624894  0.2305909  8.177561e-01
## incomegp4    0.09072124 0.12059542  0.7522777  4.523474e-01
## incomegp5    0.40760033 0.11392712  3.5777288  3.911633e-04
## cigbuy1     -0.01088742 0.07672982 -0.1418929  8.872394e-01</code></pre>
<p>In the model, the baseline group is for non-cigarette buyers (<code>cigbuy = 0</code>)
and income group 1 with <span class="math inline">\(\widehat{\alpha} = 3.131\)</span> points. Regardless of the
<code>cigbuy</code> level, the difference between income groups 2 and 1 is estimated
to be <span class="math inline">\(\widehat{\tau}_2 = -0.054\)</span>, an decrease in the mean score of 0.054 points.
The difference between income groups 3 and 1 is <span class="math inline">\(\widehat{\tau}_3 = 0.027\)</span>
points, regardless of cigarette smoking status. The estimated difference
between cigarette buyers and non-buyers was estimated as
<span class="math inline">\(\widehat{\gamma}_2 = -0.011\)</span> points for any income group, remember that this
variable had a large p-value in this model. The additive model-based estimates for all
six combinations can be found in Table <a href="chapter4.html#tab:Table4-3">4.3</a>.</p>
<!-- \newpage -->

<table>
<caption><span id="tab:Table4-3">Table 4.3: </span> Calculations to construct the estimates for all combinations of variables for the <code>prodebt</code> additive model.</caption>
<colgroup>
<col width="11%" />
<col width="13%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><span class="math inline">\(\color{red}{\text{Cig}}\)</span><br />
<span class="math inline">\(\color{red}{\text{Buy}}\)</span></th>
<th align="left"><span class="math inline">\(\color{blue}{\textbf{Income}}\)</span><br />
<span class="math inline">\(\color{blue}{\textbf{Group 1}}\)</span></th>
<th align="left"><span class="math inline">\(\color{blue}{\textbf{Income}}\)</span><br />
<span class="math inline">\(\color{blue}{\textbf{Group 2}}\)</span></th>
<th align="left"><span class="math inline">\(\color{blue}{\textbf{Income}}\)</span><br />
<span class="math inline">\(\color{blue}{\textbf{Group 3}}\)</span></th>
<th align="left"><span class="math inline">\(\color{blue}{\textbf{Income}}\)</span><br />
<span class="math inline">\(\color{blue}{\textbf{Group 4}}\)</span></th>
<th align="left"><span class="math inline">\(\color{blue}{\textbf{Income}}\)</span><br />
<span class="math inline">\(\color{blue}{\textbf{Group 5}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\color{red}{\text{0:No}}\)</span></td>
<td align="left"><span class="math inline">\(\widehat{\alpha} ={3.131}\)</span></td>
<td align="left"><span class="math inline">\(\widehat{\alpha} + \widehat{\tau}_2\)</span><br />
<span class="math inline">\(=3.131 - 0.016\)</span><br />
<span class="math inline">\(= 3.115\)</span></td>
<td align="left"><span class="math inline">\(\widehat{\alpha} + \widehat{\tau}_3\)</span><br />
<span class="math inline">\(=3.131 + 0.027\)</span><br />
<span class="math inline">\(= 3.158\)</span></td>
<td align="left"><span class="math inline">\(\widehat{\alpha} + \widehat{\tau}_4\)</span><br />
<span class="math inline">\(=3.131 + 0.091\)</span><br />
<span class="math inline">\(= 3.222\)</span></td>
<td align="left"><span class="math inline">\(\widehat{\alpha} + \widehat{\tau}_5\)</span><br />
<span class="math inline">\(=3.131 + 0.408\)</span><br />
<span class="math inline">\(= 3.539\)</span><br />
</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\color{red}{\text{1:}\text{Yes}}\)</span></td>
<td align="left"><span class="math inline">\(\widehat{\alpha}+\widehat{\gamma}_2\)</span><br />
<span class="math inline">\(=3.131\)</span><br />
<span class="math inline">\(-0.011\)</span><br />
<span class="math inline">\(=3.142\)</span></td>
<td align="left"><span class="math inline">\(\widehat{\alpha}+\widehat{\tau}_2+\widehat{\gamma}_2\)</span><br />
<span class="math inline">\(=3.131 - 0.016\)</span><br />
<span class="math inline">\(- 0.011\)</span><br />
<span class="math inline">\(=3.104\)</span></td>
<td align="left"><span class="math inline">\(\widehat{\alpha}+\widehat{\tau}_3+\widehat{\gamma}_2\)</span><br />
<span class="math inline">\(=3.131 + 0.027\)</span><br />
<span class="math inline">\(- 0.011\)</span><br />
<span class="math inline">\(=3.147\)</span></td>
<td align="left"><span class="math inline">\(\widehat{\alpha}+\widehat{\tau}_4+\widehat{\gamma}_2\)</span><br />
<span class="math inline">\(=3.131 + 0.091\)</span><br />
<span class="math inline">\(- 0.011\)</span><br />
<span class="math inline">\(=3.211\)</span></td>
<td align="left"><span class="math inline">\(\widehat{\alpha}+\widehat{\tau}_5+\widehat{\gamma}_2\)</span><br />
<span class="math inline">\(=3.131 + 0.408\)</span><br />
<span class="math inline">\(- 0.011\)</span><br />
<span class="math inline">\(=3.528\)</span></td>
</tr>
</tbody>
</table>
<p>One final plot of the fitted values
from this additive model in Figure <a href="chapter4.html#fig:Figure4-20">4.20</a> hopefully crystallizes
the implications
of an additive model and reinforces that this model creates and assumes that
the differences across levels of one variable are the same regardless of the
level of the other variable and that this creates parallel lines. The
difference between <code>cigbuy</code> levels across all income groups is a drop in
-0.011 points. The income groups
have the same differences regardless of cigarette buying or not, with income
group 5 much higher than the other four groups. The minor differences in cigarette purchasing and large p-value for it controlled for income group suggest that we could also refine the model further and drop the <code>cigbuy</code> additive term and just focus on the income groups as a predictor – and this takes us right back to a One-Way ANOVA model so is not repeated here.</p>

<div class="figure" style="text-align: center"><span id="fig:Figure4-20"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-20-1.png" alt="Illustration of the results from Table 4.3 showing the combined impacts of the components of the additive model for prodebt. Panel (a) uses income groups on the x-axis and different lines for cigarette buyers (1) or not (0). Panel (b) displays the different income groups as lines with the cigarette buying status on the x-axis." width="75%" />
<p class="caption">
Figure 4.20: Illustration of the results from Table <a href="chapter4.html#tab:Table4-3">4.3</a> showing the combined impacts of the components of the additive model for <code>prodebt</code>. Panel (a) uses income groups on the x-axis and different lines for cigarette buyers (1) or not (0). Panel (b) displays the different income groups as lines with the cigarette buying status on the x-axis.
</p>
</div>
<!-- \newpage -->
<p><strong>In general, we proceed through the following steps in any 2-WAY ANOVA situation:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Make a pirate-plot and an interaction plot.</p></li>
<li><p>Fit the interaction model; examine the test for the interaction.</p></li>
<li><p>Check the residual diagnostic plots for the interaction model (especially
normality and equal variance).</p>
<ul>
<li>If there is a problem with normality or
equal variance, consider a “transformation” of the response as discussed in
Chapter <a href="chapter7.html#chapter7">7</a>. This can help make the responses have similar
variances or responses (and the model residuals) to be more normal, but
sometimes not both. </li>
</ul></li>
<li><p>If the interaction test has a small p-value, that is your main result. Focus on
the term-plot and the interaction plot from (1) to fully understand the results, adding Tukey’s
HSD  results to <code>intplot</code> to see which means of the combinations of levels are detected as
being different. Discuss the sizes of differences and the pattern of the estimated interaction.</p></li>
<li><p>If the interaction is not considered important, then re-fit the model without
the interaction (additive model) and re-check the diagnostic plots. If the
diagnostics are reasonable to proceed:</p>
<ul>
<li><p>Focus on the results for each explanatory
variable, using Type II tests especially if the design is not balanced.
Possibly consider further model refinement to only retain one of the two
variables (the one with the smaller p-value) if a p-value is large. Follow
One-Way ANOVA recommendations from this point on.</p></li>
<li><p>Report the initial interaction test
results and the results for the test for each variable from the model
that is re-fit without the interaction.</p></li>
<li><p>Model coefficients in the additive model are interesting as they are shifts from baseline
for each level of each variable, controlling for the other variable –
interpret those differences if the number of levels is not
too great.</p></li>
</ul></li>
</ol>
<p>Whether you end up favoring an additive or interaction model or do further model refinement, all steps of the
hypothesis testing protocol should be engaged and a story based on the final results should be compiled, supported by the graphical displays such as the term-plots and interaction plots.</p>
</div>
<div id="section4-6" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Pushing Two-Way ANOVA to the limit: Un-replicated designs and Estimability</h2>
<p>In some situations, it is too expensive
or impossible to replicate combinations of treatments and only one observation at each
combination of the two explanatory variables, A and B, is possible. In these
situations, even though we have information about all combinations of A and B,
it is no longer possible to test for an interaction. Our regular rules for
degrees of freedom show that we have nothing left for the error degrees of
freedom and so we have to drop the interaction and call that potential
interaction variability “error.”

</p>
<div style="page-break-after: always;"></div>
<p>Without replication we can still perform an analysis of the
responses and estimate all the coefficients in the interaction model but an issue occurs with trying to calculate the interaction
<span class="math inline">\(F\)</span>-test statistic – we run out of degrees of freedom for the error. To
illustrate these methods, the paper towel example
is revisited except that only one response for each combination is used. Now
the entire data set can be easily printed out:</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="chapter4.html#cb386-1" aria-hidden="true" tabindex="-1"></a>ptR <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;http://www.math.montana.edu/courses/s217/documents/ptR.csv&quot;</span>)</span>
<span id="cb386-2"><a href="chapter4.html#cb386-2" aria-hidden="true" tabindex="-1"></a>ptR <span class="ot">&lt;-</span> ptR <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dropsf =</span> <span class="fu">factor</span>(drops),</span>
<span id="cb386-3"><a href="chapter4.html#cb386-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">brand =</span> <span class="fu">factor</span>(brand))</span>
<span id="cb386-4"><a href="chapter4.html#cb386-4" aria-hidden="true" tabindex="-1"></a>ptR</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   brand drops responses dropsf
##   &lt;fct&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt; 
## 1 B1       10     1.91  10    
## 2 B2       10     3.05  10    
## 3 B1       20     0.774 20    
## 4 B2       20     2.84  20    
## 5 B1       30     1.56  30    
## 6 B2       30     0.547 30</code></pre>
<p>Upon first inspection the interaction plot in Figure <a href="chapter4.html#fig:Figure4-21">4.21</a>
looks like there might be
some interesting interactions present with lines that look to be non-parallel. But remember now that there is only a
single observation at each combination of the brands and water levels so there
is not much power to detect differences in this sort of situation and no replicates
at any combinations of levels that allow estimation of SEs so no bands are produced in the
plot. 
</p>

<div class="figure" style="text-align: center"><span id="fig:Figure4-21"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-21-1.png" alt="Interaction plot in paper towel data set with no replication." width="75%" />
<p class="caption">
Figure 4.21: Interaction plot in paper towel data set with no replication.
</p>
</div>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="chapter4.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intplot</span>(responses <span class="sc">~</span> brand <span class="sc">*</span> dropsf, <span class="at">data =</span> ptR, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The next step would be to assess evidence related to the null hypothesis
of no interaction between <code>Brand</code> and <code>Drops</code>. A problem will arise in
trying to form the ANOVA table as you would see this when you run the
<code>anova</code><a href="#fn94" class="footnote-ref" id="fnref94"><sup>94</sup></a> function on the
interaction model: </p>
<div style="page-break-after: always;"></div>
<!-- \small -->
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="chapter4.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(responses <span class="sc">~</span> dropsf <span class="sc">*</span> brand, <span class="at">data =</span> ptR))</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## Response: responses
##              Df  Sum Sq Mean Sq F value Pr(&gt;F)
## dropsf        2 2.03872 1.01936               
## brand         1 0.80663 0.80663               
## dropsf:brand  2 2.48773 1.24386               
## Residuals     0 0.00000                       
## Warning message:
## In anova.lm(lm(responses ~ dropsf * brand, data = ptR)) :
##   ANOVA F-tests on an essentially perfect fit are unreliable</code></pre>
<!-- \normalsize -->
<p>Warning messages in R output show up after you run functions that contain
problems and are generally not a good thing, but can sometimes be ignored. In
this case, the warning message is not needed – there are no <span class="math inline">\(F\)</span>-statistics or
p-values in the results so we know there are some issues with the results. The
<strong>Residuals</strong> line is key here – Residuals with 0 <em>df</em> and sums of
squares of 0. Without replication, there are no degrees of freedom left to
estimate the residual error. My first statistics professor,
Dr. Gordon Bril at Luther College, used to refer to this as “shooting your load” by
fitting too many terms in the model given the number of observations available.
Maybe this is a bit graphic but hopefully will help you remember the need for
replication if you want to test for interactions – it did for me. Without
replication of observations, we run out of information to test all
the desired model components.</p>
<p>So what can we do if we can’t afford replication but want to study two variables in the same study? We can <em>assume</em> that the
interaction does not exist and use those degrees of freedom and variability as
the error variability. When we drop the interaction from Two-Way
models, the interaction variability is added into the <span class="math inline">\(\text{SS}_E\)</span>
so we assume that the interaction variability is really just “noise,” which may not actually be true. We are not able to test for an
interaction so must rely on the interaction plot to assess whether an interaction
might be present. Figure <a href="chapter4.html#fig:Figure4-20">4.20</a> suggests there might be an
interaction in these data (the
two brands’ lines suggesting non-parallel lines).

So in this
case, assuming no interaction is present is hard to justify. But if we proceed
under this dangerous and untestable assumption, tests for the main effects can be developed.
</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="chapter4.html#cb391-1" aria-hidden="true" tabindex="-1"></a>norep1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(responses <span class="sc">~</span> dropsf <span class="sc">+</span> brand, <span class="at">data =</span> ptR)</span>
<span id="cb391-2"><a href="chapter4.html#cb391-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(norep1)</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: responses
##            Sum Sq Df F value Pr(&gt;F)
## dropsf    2.03872  2  0.8195 0.5496
## brand     0.80663  1  0.6485 0.5052
## Residuals 2.48773  2</code></pre>
<p>In the additive model, the last row of the ANOVA table that is called the
<code>Residuals</code> row is really the interaction row from the interaction model
ANOVA table. Neither main effect had a small p-value
(<em>Drops</em>: <span class="math inline">\(F(2,2) = 0.82, \text{ p-value} = 0.55\)</span> and
<em>Brand</em>: <span class="math inline">\(F(1,2) = 0.65, \text{ p-value} = 0.51\)</span>) in the additive model. To
get small p-values with the small sample sizes that unreplicated designs would generate, the differences would need to be
<strong>very</strong> large because the residual degrees of freedom have become very small.
 
The term-plots in Figure <a href="chapter4.html#fig:Figure4-22">4.22</a> show that the
differences among the levels are small relative to the residual variability as
seen in the error bars around each point estimate.</p>

<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="chapter4.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(norep1))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-22"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-22-1.png" alt="Term-plots for the additive model in paper towel data set with no replication." width="75%" />
<p class="caption">
Figure 4.22: Term-plots for the additive model in paper towel data set with no replication.
</p>
</div>
<p>In the extreme unreplicated situation it is possible to estimate all model coefficients in the interaction model but we can’t do inferences for those estimates since there is no residual variability. Another issue in really any model with categorical predictors but especially noticeable in the Two-Way ANOVA situation is <strong><em>estimability</em></strong> issues.  Instead of having issues with running out of degrees of freedom for tests we can run into situations where we do not have information to estimate some of the model coefficients. This happens any time you fail to have observations at either a level of a main effect or at a combination of levels in an interaction model.</p>
<p>To illustrate estimability issues, we will revisit the overtake data. Each of the seven levels of outfits was made up of a combination of different characteristics of the outfits, such as which helmet and pants were chosen, whether reflective leg clips were worn or not, etc. To see all these additional variables, we will introduce a new plot that will feature more prominently in Chapter <a href="chapter5.html#chapter5">5</a> that allows us to explore relationships among a suite of categorical variables – the <code>tableplot</code> from the <code>tabplot</code><a href="#fn95" class="footnote-ref" id="fnref95"><sup>95</sup></a> package <span class="citation">(<a href="#ref-R-tabplot" role="doc-biblioref">Tennekes and de Jonge 2019</a>)</span>. It allows us to sort the variables based on a single variable (think about how you might sort a spreadsheet based on one column and look at the results in other columns). The <code>tableplot</code> function displays bars for each response in a row<a href="#fn96" class="footnote-ref" id="fnref96"><sup>96</sup></a> based on the
category of responses or as a bar with the height corresponding
the value of quantitative variables<a href="#fn97" class="footnote-ref" id="fnref97"><sup>97</sup></a>.


It also plots a red cell if the
observations were missing for a categorical variable and in grey for missing values on quantitative variables. The plot can be obtained
simply as <code>tableplot(DATASETNAME)</code> which will sort the data set based on the first variable. To use our previous work with the sorted levels of <code>Condition2</code>, the code <code>dd[,-1]</code> is used to specify the data set without <code>Condition</code> and then <code>sort = Condition2</code> is used to sort based on the <code>Condition2</code> variable. The <code>pals = list("BrBG")</code> option specifies a color palette for the plot that is color-blind friendly from the <code>RColorBrewer</code> package <span class="citation">(<a href="#ref-R-RColorBrewer" role="doc-biblioref">Neuwirth 2014</a>)</span>.
</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="chapter4.html#cb394-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;http://www.math.montana.edu/courses/s217/documents/Walker2014_mod.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="chapter4.html#cb395-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> dd <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Condition =</span> <span class="fu">factor</span>(Condition),</span>
<span id="cb395-2"><a href="chapter4.html#cb395-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Condition2 =</span> <span class="fu">reorder</span>(Condition, Distance, <span class="at">FUN =</span> mean),</span>
<span id="cb395-3"><a href="chapter4.html#cb395-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Shirt =</span> <span class="fu">factor</span>(Shirt),</span>
<span id="cb395-4"><a href="chapter4.html#cb395-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Helmet =</span> <span class="fu">factor</span>(Helmet),</span>
<span id="cb395-5"><a href="chapter4.html#cb395-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Pants =</span> <span class="fu">factor</span>(Pants),</span>
<span id="cb395-6"><a href="chapter4.html#cb395-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Gloves =</span> <span class="fu">factor</span>(Gloves),</span>
<span id="cb395-7"><a href="chapter4.html#cb395-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ReflectClips =</span> <span class="fu">factor</span>(ReflectClips),</span>
<span id="cb395-8"><a href="chapter4.html#cb395-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Backpack =</span> <span class="fu">factor</span>(Backpack)</span>
<span id="cb395-9"><a href="chapter4.html#cb395-9" aria-hidden="true" tabindex="-1"></a>                    )</span></code></pre></div>

<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="chapter4.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(remotes); </span>
<span id="cb396-2"><a href="chapter4.html#cb396-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;mtennekes/tabplot&quot;</span>) <span class="co"># Only do this once on your computer</span></span></code></pre></div>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="chapter4.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(remotes); </span>
<span id="cb397-2"><a href="chapter4.html#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;tabplot&quot;</span>, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb397-3"><a href="chapter4.html#cb397-3" aria-hidden="true" tabindex="-1"></a>        remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;mtennekes/tabplot&quot;</span>)</span>
<span id="cb397-4"><a href="chapter4.html#cb397-4" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb397-5"><a href="chapter4.html#cb397-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabplot)</span>
<span id="cb397-6"><a href="chapter4.html#cb397-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb397-7"><a href="chapter4.html#cb397-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Options (sometimes) needed to prevent errors on PC</span></span>
<span id="cb397-8"><a href="chapter4.html#cb397-8" aria-hidden="true" tabindex="-1"></a><span class="co"># options(ffbatchbytes = 1024^2 * 128); options(ffmaxbytes = 1024^2 * 128 * 32) </span></span>
<span id="cb397-9"><a href="chapter4.html#cb397-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tableplot</span>(dd[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">sort =</span> Condition2, <span class="at">pals =</span> <span class="fu">list</span>(<span class="st">&quot;BrBG&quot;</span>), <span class="at">sample =</span> F, </span>
<span id="cb397-10"><a href="chapter4.html#cb397-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">colorNA_num =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">numMode =</span> <span class="st">&quot;MB-ML&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Figure4-23"></span>
<img src="04-twoWayAnova_files/figure-html/Figure4-23-1.png" alt="Tableplot of the full overtake data set sorted by outfit worn (Condition2)." width="75%" />
<p class="caption">
Figure 4.23: Tableplot of the full overtake data set sorted by outfit worn (<code>Condition2</code>).
</p>
</div>
<p>In the tableplot in Figure <a href="chapter4.html#fig:Figure4-23">4.23</a>, we can now explore the six variables created related to aspects of each outfit. For example, the <em>commuter</em> helmet (darkest shade in <code>Helmet</code> column) was worn with all outfits except for the <em>racer</em> and <em>casual</em>. So maybe we would like to explore differences in overtake distances based on the type of helmet worn. Similarly, it might be nice to explore whether wearing reflective pant clips is useful and maybe there is an interaction between helmet type and leg clips on impacts on overtake distance (should we wear both or just one, for example). So instead of using the seven level <code>Condition2</code> in the model to assess differences based on all combinations of these outfits delineated in the other variables, we can try to fit a model with <code>Helmet</code> and <code>ReflectClips</code> and their interaction for overtake distances:</p>
<!-- \newpage -->
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="chapter4.html#cb398-1" aria-hidden="true" tabindex="-1"></a>overtake_int <span class="ot">&lt;-</span> <span class="fu">lm</span>(Distance <span class="sc">~</span> Helmet <span class="sc">*</span> ReflectClips, <span class="at">data =</span> dd)</span>
<span id="cb398-2"><a href="chapter4.html#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(overtake_int)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Distance ~ Helmet * ReflectClips, data = dd)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -115.111  -17.756   -0.611   16.889  156.889 
## 
## Coefficients: (3 not defined because of singularities)
##                            Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                117.1106     0.4710 248.641   &lt;2e-16
## Helmethat                    0.5004     1.1738   0.426    0.670
## Helmetrace                  -0.3547     1.1308  -0.314    0.754
## ReflectClipsyes                  NA         NA      NA       NA
## Helmethat:ReflectClipsyes        NA         NA      NA       NA
## Helmetrace:ReflectClipsyes       NA         NA      NA       NA
## 
## Residual standard error: 30.01 on 5687 degrees of freedom
## Multiple R-squared:  5.877e-05,  Adjusted R-squared:  -0.0002929 
## F-statistic: 0.1671 on 2 and 5687 DF,  p-value: 0.8461</code></pre>
<p>The full model summary shows some odd things. First there is a warning after <code>Coefficients</code> of <code>(3 not defined because of singularities)</code>. And then in the coefficient table, there are <code>NA</code>s for everything in the rows for <code>ReflectClipsyes</code> and the two interaction components. When <code>lm</code> encounters models where the data measured are not sufficient to estimate the model, it essentially drops parts of the model that you were hoping to estimate and only estimates what it can. In this case, it just estimates coefficients for the intercept and two deviation coefficients for <code>Helmet</code> types; the other three coefficients (<span class="math inline">\(\gamma_2\)</span> and the two <span class="math inline">\(\omega\)</span>s) are <em>not estimable</em>. This reinforces the need to check coefficients in any model you are fitting. A tally of the counts of observations across the two explanatory variables helps to understand the situation and problem:</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="chapter4.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(Helmet <span class="sc">~</span> ReflectClips, <span class="at">data =</span> dd)</span></code></pre></div>
<pre><code>##           ReflectClips
## Helmet       no  yes
##   commuter    0 4059
##   hat       779    0
##   race        0  852</code></pre>
<p>There are three combinations that have <span class="math inline">\(n_{jk} = 0\)</span> observations (for example for the <em>commuter</em> helmet, clips were always worn so no observations were made with this helmet without clips). So we have no hope of estimating a mean for the combinations with 0 observations and these are needed to consider interactions. If we revisit the tableplot, we can see how some of these needed combinations do not occur together. So this is an unbalanced design but also lacks necessary information to explore the potential research question of interest. In order to study just these two variables and their interaction, the researchers would have had to do rides with all six combinations of these variables. This could be quite informative because it could help someone tailor their outfit choice for optimal safety but also would have created many more than seven different outfit combinations to wear.</p>
<p>Hopefully by pushing the limits there
are three conclusions available from this section. First, replication is
important, both in being able to perform tests for interactions and for having
enough power to detect differences for the main effects. Second, when dropping
from the interaction model to additive model, the variability explained by the
interaction term is pushed into the error term, whether replication is
available or not. Third, we need to make sure we have observations at all combinations of variables if we want to be able to estimate models using them and their interaction.</p>
<!-- \newpage -->
</div>
<div id="section4-7" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Chapter summary</h2>
<p>In this chapter, methods for handling two different categorical predictors
in the same model with a
continuous response were developed. The methods build on techniques from
Chapter <a href="chapter3.html#chapter3">3</a> for the One-Way ANOVA and there are connections
between the two
models. This was most clearly seen in the Guinea Pig data set that was analyzed
in both chapters. When two factors are available, it is better to start with
the methods developed in this chapter because the interaction between the
factors can, potentially, be separated from their main effects. The additive
model is easier to interpret but should only be used when you are not convinced that there is an
interaction is present. When an interaction is determined to be present, the
main effects should not be interpreted and the interaction plot in combination
with Tukey’s HSD provides information on the important aspects of the results.</p>
<ul>
<li><p>If the interaction is retained in the model, there are two things you want
to do with interpreting the interaction:</p>
<ol style="list-style-type: decimal">
<li><p>Describe the interaction, going through the changes from left to right
in the interaction plot or term-plot for each level of the other variable.</p></li>
<li><p>Suggest optimal and worst combinations of the two variables to describe the highest and lowest possible estimated mean responses.</p>
<ol style="list-style-type: lower-alpha">
<li>For example, you might want to identify a dosage and delivery
method for the guinea pigs to recommend and one to avoid if you
want to optimize odontoblast growth.</li>
</ol></li>
</ol></li>
<li><p>If there is no interaction, then the additive model provides information
on each of the variables and the differences across levels of each variable
are the same regardless of the levels of the other variable.</p>
<ul>
<li>You can describe the deviations from baseline as in Chapter <a href="chapter3.html#chapter3">3</a>,
but for each variable, noting that you are controlling for the other variable.</li>
</ul></li>
</ul>
<p>Some statisticians might have different
recommendations for dealing with interactions and main effects, especially in
the context of models with interactions. We have chosen to focus on tests for
interactions to screen for “real” interactions and then interpret the
interaction plots aided by the Tukey’s HSD for determining which combinations
of levels are detectably different. Some suggest exploring the main
effects tests even with interactions present. In some cases, those results are
interesting but in others the results can be misleading and we wanted to avoid
trying to parse out the scenarios when it might be safe to focus on the main effects in the presence of important interactions. Consider two scenarios, one where
the main effects have large p-values but the interaction has a small p-value
and the other where the main effects and the interaction all have small
p-values. The methods discussed in this chapter allow us to effectively arrive
at the interpretation of the differences in the results across the combinations
of the treatments due to the interaction having a small p-value in both cases. The main
effects results are secondary results at best when the interaction is important
because we know that impacts of one explanatory variable is changing based on
the levels of the other variable.</p>
<p>Chapter <a href="chapter5.html#chapter5">5</a> presents a bit of a different set of statistical
methods that allow analyses of data sets similar
to those considered in the last two chapters but with a categorical response
variable. The methods are very different in application but are quite similar in overall goals
to those in Chapter <a href="chapter3.html#chapter3">3</a> where differences in responses where explored
across groups. After Chapter <a href="chapter5.html#chapter5">5</a>, the rest of the book will
return to fitting models using the <code>lm</code> function as used here, but
incorporating quantitative predictor variables and
then eventually incorporating both categorical and quantitative predictor
variables. The methods in Chapter <a href="chapter8.html#chapter8">8</a> are actually quite similar
to those considered here, so the better you understand these models, the easier that material will be to master.</p>
</div>
<div id="section4-8" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Summary of important R code</h2>
<p>The main components of R code used in this chapter follow with components to
modify in lighter and/or ALL CAPS text, remembering that any R
packages mentioned need to be installed and loaded for this code to have a
chance of working:</p>
<ul>
<li><p><strong>tally(<font color='red'>A</font> ~ <font color='red'>B</font>,
data = <font color='red'>DATASETNAME</font>)</strong></p>
<ul>
<li><p>Requires the <code>mosaic</code> package be loaded.</p></li>
<li><p>Provides the counts of observations in each combination of categorical
predictor variables A and B, used to check for balance and understand sample
sizes in each combination. </p></li>
</ul></li>
<li><p><strong><font color='red'>DATASETNAME</font> &lt;- <font color='red'>DATASETNAME</font> %&gt;% mutate(<font color='red'>VARIABLENAME</font> = factor(<font color='red'>VARIABLENAME</font>))</strong></p>
<ul>
<li>Use the <code>factor</code> function on any numerically coded
explanatory variable where the numerical codes represent levels of a
categorical variable. </li>
</ul></li>
<li><p><strong>intplot(<font color='red'>Y</font> ~ <font color='red'>A</font><code>*</code><font color='red'>B</font>,
data = <font color='red'>DATASETNAME</font>)</strong></p>
<ul>
<li><p>Available in the <code>catstats</code> package or download and install using:</p>
<p><code>source("http://www.math.montana.edu/courses/s217/documents/intplotfunctions_v3.R")</code></p></li>
<li><p>Provides interaction plot. </p></li>
</ul></li>
<li><p><strong>intplotarray(<font color='red'>Y</font> ~ <font color='red'>A</font><code>*</code><font color='red'>B</font>,
data = <font color='red'>DATASETNAME</font>)</strong></p>
<ul>
<li><p>Available in <code>catstats</code> or download and install using:</p>
<p><code>source("http://www.math.montana.edu/courses/s217/documents/intplotfunctions_v3.R")</code></p></li>
<li><p>Provides interaction plot array that makes interaction plots switching explanatory variable roles and makes pirate-plots of the main effects.
</p></li>
</ul></li>
<li><p><strong><font color='red'>INTERACTIONMODELNAME</font> <code>&lt;-</code>
lm(<font color='red'>Y</font> ~ <font color='red'>A</font><code>*</code><font color='red'>B</font>,
data = <font color='red'>DATASETNAME</font>)</strong></p>
<ul>
<li><p>Fits the interaction model with main effects for A and B and an
interaction between them.</p></li>
<li><p>This is the first model that should be fit in Two-Way ANOVA
modeling situations.</p></li>
</ul></li>
<li><p><strong><font color='red'>ADDITIVEMODELNAME</font> <code>&lt;-</code>
lm(<font color='red'>Y</font> ~ <font color='red'>A</font> + <font color='red'>B</font>,
data = <font color='red'>DATASETNAME</font>)</strong></p>
<ul>
<li><p>Fits the additive model with only main effects for A and B but no
interaction between them.</p></li>
<li><p>Should only be used if the interaction has been decided to be
unimportant using a test for the interaction.</p></li>
</ul></li>
<li><p><strong>summary(<font color='red'>MODELNAME</font>)</strong></p>
<ul>
<li>Generates model summary information including the estimated model coefficients,
SEs, <span class="math inline">\(t\)</span>-tests, and p-values.</li>
</ul></li>
<li><p><strong>Anova(<font color='red'>MODELNAME</font>)</strong></p>
<ul>
<li><p>Requires the <code>car</code> package to be loaded.</p></li>
<li><p>Generates a Type II Sums of Squares ANOVA table that is useful for
both additive and interaction models, but it is most important to use
when working with the additive model as it provides inferences for
each term conditional on the other one. </p></li>
</ul></li>
<li><p><strong>par(mfrow = c(2,2)); plot(<font color='red'>MODELNAME</font>)</strong></p>
<ul>
<li>Generates four diagnostic plots including the Residuals vs Fitted and
Normal Q-Q plot.</li>
</ul></li>
<li><p><strong>plot(allEffects(<font color='red'>MODELNAME</font>))</strong></p>
<ul>
<li><p>Requires the <code>effects</code> package be loaded.</p></li>
<li><p>Plots the results from the estimated model.
</p></li>
</ul></li>
<li><p><strong>plot(allEffects(<font color='red'>MODELNAME</font>, residuals = T))</strong></p>
<ul>
<li>Plots the results from the estimated model with partial residuals.</li>
</ul></li>
</ul>
<!-- \newpage -->
</div>
<div id="section4-9" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Practice problems</h2>
<p>4.1. <strong>Mathematics Usage Test Scores Analysis</strong> To practice the Two-Way ANOVA, consider a data set on <span class="math inline">\(N = 861\)</span> ACT
Mathematics Usage Test scores from 1987. The test was given to a
sample of high school seniors who met one of three profiles of high school
mathematics course
work: (a) Algebra I only; (b) two Algebra courses and Geometry; and (c) two
Algebra courses, Geometry, Trigonometry, Advanced Mathematics, and Beginning
Calculus. These data were generated from summary statistics for one particular
form of the test as reported by <span class="citation"><a href="#ref-Doolittle1989" role="doc-biblioref">Doolittle and Welch</a> (<a href="#ref-Doolittle1989" role="doc-biblioref">1989</a>)</span>. The source of this version of
the data set is <span class="citation"><a href="#ref-Ramsey2012" role="doc-biblioref">Ramsey and Schafer</a> (<a href="#ref-Ramsey2012" role="doc-biblioref">2012</a>)</span> and the <code>Sleuth3</code> package
<span class="citation">(<a href="#ref-R-Sleuth3" role="doc-biblioref">F. L. Ramsey et al. 2019</a>)</span>. 
First install and then load that package.</p>
<pre><code>library(Sleuth3)
library(mosaic)
library(tibble)
math &lt;- as_tibble(ex1320)
math
names(math)
favstats(Score ~ Sex + Background, data = math)</code></pre>
<p>4.1.1. Use the <code>favstats</code> summary to discuss whether the design was balanced or not.</p>
<p>4.1.2. Make a pirate-plot and
interaction plot array of the results and discuss the relationship between Sex,
Background, and ACT Score.</p>
<p>4.1.3. Write out the interaction model in
terms of the Greek letters, making sure to define all the terms and don’t
forget the error terms in the model.</p>
<p>4.1.4. Fit the interaction plot and find
the ANOVA table. For the test you should consider first (the interaction),
write out the hypotheses, report the test statistic, p-value, distribution of
the test statistic under the null, and write a conclusion related to the
results of this test.</p>
<p>4.1.5. Re-fit the model as an additive
model (why is this reasonable here?) and use <code>Anova</code> to find the Type II sums of
squares ANOVA. Write out the hypothesis for the Background variable, report the
test statistic, p-value, distribution of the test statistic under the null, and
write a conclusion related to the results of this test. Make sure to discuss the scope of inference for this result.</p>
<p>4.1.6. Use the <code>effects</code> package to make a term-plot from the
additive model from 4.5 and discuss the results. Specifically, discuss what you
can conclude about the average relationship across both sexes, between
Background and average ACT score?</p>
<p>4.1.7. Add partial residuals to the term-plot and make our standard diagnostic plots
and assess the assumptions using these plots. Can you assess independence using
these plots? Discuss this assumption in this situation.</p>
<p>4.1.8. Use the term-plot and the estimated model
coefficients to determine which of the combinations of levels provides the
highest estimated average score.</p>
<p>4.2. <strong>Sleep Quality Analysis</strong> As a second example, consider data based on Figure 3 from <span class="citation"><a href="#ref-Puhan2006" role="doc-biblioref">Puhan et al.</a> (<a href="#ref-Puhan2006" role="doc-biblioref">2006</a>)</span>, which is
available at <a href="http://www.bmj.com/content/332/7536/266" class="uri">http://www.bmj.com/content/332/7536/266</a>. In this study, the
researchers were interested in whether didgeridoo playing might impact sleep
quality (and therefore daytime sleepiness). They obtained volunteers and they
randomized the subjects to either get a lesson or be placed on a waiting list
for lessons. They constrained the randomization based on the high/low apnoea
and high/low on the Epworth scale of the subjects in their initial observations
to make sure they balanced the types of subjects going into the treatment and
control groups. They measured the subjects’ Epworth value (daytime sleepiness,
higher is more sleepy) initially and after four months, where only the treated
subjects (those who took lessons) had any intervention. We are interested in
whether the mean Epworth scale values changed differently over the four months
in the group that got didgeridoo lessons than it did in the control group (that
got no lessons). Each subject was measured twice in the data set provided that
is available at <a href="http://www.math.montana.edu/courses/s217/documents/epworthdata.csv" class="uri">http://www.math.montana.edu/courses/s217/documents/epworthdata.csv</a>.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="chapter4.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb403-2"><a href="chapter4.html#cb403-2" aria-hidden="true" tabindex="-1"></a>epworthdata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;http://www.math.montana.edu/courses/s217/documents/epworthdata.csv&quot;</span>)</span>
<span id="cb403-3"><a href="chapter4.html#cb403-3" aria-hidden="true" tabindex="-1"></a>epworthdata <span class="ot">&lt;-</span> epworthdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">factor</span>(Time),</span>
<span id="cb403-4"><a href="chapter4.html#cb403-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">Group =</span> <span class="fu">factor</span>(Group)</span>
<span id="cb403-5"><a href="chapter4.html#cb403-5" aria-hidden="true" tabindex="-1"></a>                                      )</span>
<span id="cb403-6"><a href="chapter4.html#cb403-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(epworthdata<span class="sc">$</span>Time) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Pre&quot;</span> , <span class="st">&quot;Post&quot;</span>)</span>
<span id="cb403-7"><a href="chapter4.html#cb403-7" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(epworthdata<span class="sc">$</span>Group) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span> , <span class="st">&quot;Didgeridoo&quot;</span>)</span></code></pre></div>
<p>4.2.1. Make a pirate-plot and an interaction plot array to graphically explore
the potential interaction of Time and Group on the Epworth responses.</p>
<p>4.2.2. Fit the interaction model and find
the ANOVA table. For the test you should consider first (the interaction),
write out the hypotheses, report the test statistic, p-value, distribution of
the test statistic under the null, and write a conclusion related to the
results of this test.</p>
<p>4.2.3. Discuss the independence assumption for the previous model. The researchers used an analysis based on matched pairs. Discuss how using ideas from matched pairs might be applicable to the scenario discussed here.</p>
<p>4.2.4. Refine the model based on the previous test result and continue refining the model as the results might suggest. This should lead to retaining just a single variable. Make term-plot plot for this model and discuss this result related to the intent of the original research. If you read the original paper, they did find evidence of an effect of learning to play the didgeridoo (that there was a different change over time in the treated control when compared to the control group) – why might they have gotten a different result (hint: think about the previous question).</p>
<p>Note that the didgeridoo example is revisited in the case-studies in Chapter <a href="chapter9.html#chapter9">9</a> with some information on an even better way to analyze these data.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Doolittle1989" class="csl-entry">
Doolittle, Alan E., and Catherine Welch. 1989. <span>“Gender Differences in Performance on a College-Level Acheivement Test.”</span> <em>ACT Research Report</em>, 89–90.
</div>
<div id="ref-R-Sleuth3" class="csl-entry">
F. L. Ramsey, Original by, D. W. Schafer; modifications by Daniel W. Schafer, Jeannie Sifneos, Berwin A. Turlach; vignettes contributed by Nicholas Horton, Linda Loi, Kate Aloisio, Ruobing Zhang, and with corrections by Randall Pruim. 2019. <em>Sleuth3: Data Sets from Ramsey and Schafer’s "Statistical Sleuth (3rd Ed)"</em>. <a href="http://r-forge.r-project.org/projects/sleuth2/">http://r-forge.r-project.org/projects/sleuth2/</a>.
</div>
<div id="ref-R-faraway" class="csl-entry">
Faraway, Julian. 2016. <em>Faraway: Functions and Datasets for Books by Julian Faraway</em>. <a href="http://people.bath.ac.uk/jjf23/">http://people.bath.ac.uk/jjf23/</a>.
</div>
<div id="ref-Fox2011" class="csl-entry">
Fox, John, and Sanford Weisberg. 2011. <em>An <span>R-Companion</span> to Applied Regression, Second Edition</em>. Thousand Oaks, CA: SAGE Publications. <a href="http://socserv.socsci.mcmaster.ca/jfox/Books/Companion">http://socserv.socsci.mcmaster.ca/jfox/Books/Companion</a>.
</div>
<div id="ref-R-car" class="csl-entry">
———. 2021. <em>Car: Companion to Applied Regression</em>. <a href="https://CRAN.R-project.org/package=car">https://CRAN.R-project.org/package=car</a>.
</div>
<div id="ref-R-catstats" class="csl-entry">
Greenwood, Mark. 2021. <em>Catstats: Statistics for Montana State University Bobcats</em>. <a href="https://github.com/greenwood-stat/catstats">https://github.com/greenwood-stat/catstats</a>.
</div>
<div id="ref-R-remotes" class="csl-entry">
Hester, Jim, Gábor Csárdi, Hadley Wickham, Winston Chang, Martin Morgan, and Dan Tenenbaum. 2021. <em>Remotes: R Package Installation from Remote Repositories, Including GitHub</em>. <a href="https://CRAN.R-project.org/package=remotes">https://CRAN.R-project.org/package=remotes</a>.
</div>
<div id="ref-Hurlbert1984" class="csl-entry">
Hurlbert, Stuart H. 1984. <span>“Pseudoreplication and the Design of Ecological Field Experiments.”</span> <em>Ecological Monographs</em> 54 (2): 187–211. <a href="http://www.jstor.org/stable/1942661">http://www.jstor.org/stable/1942661</a>.
</div>
<div id="ref-Lea1995" class="csl-entry">
Lea, Stephen E. G., Paul Webley, and Catherine M. Walker. 1995. <span>“Psychological Factors in Consumer Debt: Money Management, Economic Socialization, and Credit Use.”</span> <em>Journal of Economic Psychology</em> 16 (4): 681–701.
</div>
<div id="ref-Likert1932" class="csl-entry">
Likert, Rensis. 1932. <span>“A Technique for the Measurement of Attitudes.”</span> <em>Archives of Psychology</em> 140: 1–55.
</div>
<div id="ref-R-RColorBrewer" class="csl-entry">
Neuwirth, Erich. 2014. <em>RColorBrewer: ColorBrewer Palettes</em>. <a href="https://CRAN.R-project.org/package=RColorBrewer">https://CRAN.R-project.org/package=RColorBrewer</a>.
</div>
<div id="ref-Puhan2006" class="csl-entry">
Puhan, Milo A, Alex Suarez, Christian Lo Cascio, Alfred Zahn, Markus Heitz, and Otto Braendli. 2006. <span>“Didgeridoo Playing as Alternative Treatment for Obstructive Sleep Apnoea Syndrome: Randomised Controlled Trial.”</span> <em>BMJ</em> 332 (7536): 266–70. <a href="https://doi.org/10.1136/bmj.38705.470590.55">https://doi.org/10.1136/bmj.38705.470590.55</a>.
</div>
<div id="ref-Ramsey2012" class="csl-entry">
Ramsey, Fred, and Daniel Schafer. 2012. <em>The Statistical Sleuth: A Course in Methods of Data Analysis</em>. Cengage Learning. <a href="https://books.google.com/books?id=eSlLjA9TwkUC">https://books.google.com/books?id=eSlLjA9TwkUC</a>.
</div>
<div id="ref-R-tabplot" class="csl-entry">
Tennekes, Martijn, and Edwin de Jonge. 2019. <em>Tabplot: Tableplot, a Visualization of Large Datasets</em>. <a href="https://github.com/mtennekes/tabplot http://
    www.jds-online.com/file_download/379/JDS-1108.pdf">https://github.com/mtennekes/tabplot http://
</div>
<div class="footnotes">
<hr />
<ol start="80">
<li id="fn80"><p>We would not suggest throwing away observations to get balanced designs. Plan in advance to try to have a balanced design but analyze the responses you get.<a href="chapter4.html#fnref80" class="footnote-back">↩︎</a></p></li>
<li id="fn81"><p>Github.com is a version control system used for software development and collaborative work, which we used to allow us to make changes to it and track the modifications. This book is also written using github to allow the same connection for writing and editing it, and one location where the digital version is hosted: <a href="https://greenwood-stat.github.io/GreenwoodBookHTML/" class="uri">https://greenwood-stat.github.io/GreenwoodBookHTML/</a>.<a href="chapter4.html#fnref81" class="footnote-back">↩︎</a></p></li>
<li id="fn82"><p>Copy and include this code in the first code chunk in
any document where you want to use the <code>intplot</code> or <code>inplotarray</code>
functions.<a href="chapter4.html#fnref82" class="footnote-back">↩︎</a></p></li>
<li id="fn83"><p>We will use “main effects” to refer to the two
explanatory variables in the additive model even if they are not randomly
assigned to contrast the terminology with having those variables involved in an interaction term in the model.
It is the one place in the book where we use “effects” without worrying about the causal connotation of that word.<a href="chapter4.html#fnref83" class="footnote-back">↩︎</a></p></li>
<li id="fn84"><p>In the standard
ANOVA table,
<span class="math inline">\(\text{SS}_A + \text{SS}_B + \text{SS}_{AB} + \text{SS}_E = \text{SS}_{\text{Total}}\)</span>.
However, to get the tests we really desire when our designs are not balanced, a
slight modification of the SS is used, using what are called Type II sums of
squares and this result doesn’t hold in the output you will see for additive
models. This is discussed further below.<a href="chapter4.html#fnref84" class="footnote-back">↩︎</a></p></li>
<li id="fn85"><p>This does not mean that there is truly no interaction in the population but does mean that we are going to proceed assuming it is not present since we couldn’t prove the null was wrong.<a href="chapter4.html#fnref85" class="footnote-back">↩︎</a></p></li>
<li id="fn86"><p>The <code>anova</code> results are not wrong, just not what we want in all situations.<a href="chapter4.html#fnref86" class="footnote-back">↩︎</a></p></li>
<li id="fn87"><p>Actually, the tests are only conditional
on other main effects if Type II Sums of Squares are used for an interaction
model, but we rarely focus on the main effect tests when the interaction is present.<a href="chapter4.html#fnref87" class="footnote-back">↩︎</a></p></li>
<li id="fn88"><p>In Multiple Linear Regression models in
Chapter <a href="chapter8.html#chapter8">8</a>, the reasons for this wording will (hopefully)
become clearer.<a href="chapter4.html#fnref88" class="footnote-back">↩︎</a></p></li>
<li id="fn89"><p>This goes beyond our considerations with character variables that have text levels but are not declared as factors in the first chapters. Those often will be modeled correctly in linear models whether they are characters or factors – but numerical variables will be modeled in a way that you did not intend for these predictors that we will discuss in Chapters <a href="chapter7.html#chapter7">7</a> and <a href="chapter8.html#chapter8">8</a>.<a href="chapter4.html#fnref89" class="footnote-back">↩︎</a></p></li>
<li id="fn90"><p>Just so you don’t think
that perfect R code should occur on the first try, I
have made similarly serious coding mistakes even after accumulating more
than decade of experience with R. It is finding those mistakes (in time) that matters.<a href="chapter4.html#fnref90" class="footnote-back">↩︎</a></p></li>
<li id="fn91"><p>To get <code>dosef</code> on the x-axis in the plot, the
<code>x.var = "dosef"</code> option was employed to force the <em>Dose</em> to be the
variable on the x-axis.<a href="chapter4.html#fnref91" class="footnote-back">↩︎</a></p></li>
<li id="fn92"><p>We can also use select to only retain these three variables and then <code>drop_na()</code> to get the same result for these three variables.<a href="chapter4.html#fnref92" class="footnote-back">↩︎</a></p></li>
<li id="fn93"><p>Correctly accounting for these missing data is a complex topic and you should not always engage <code>drop_na()</code>, but the first step to handling missing data issues is to find out (1) if you have an issue, (2) how prevalent it is, and (3) whether it is systematic in any way – in other words (and to date myself), “knowing is half the battle” with missing data. Consult a statistician or take more advanced statistics courses to explore this challenging topic further.<a href="chapter4.html#fnref93" class="footnote-back">↩︎</a></p></li>
<li id="fn94"><p>We switched back to the <code>anova</code> function here as the <code>Anova</code>
function only reports <code>Error in Anova.lm(lm(responses ~ dropsf * brand, data = ptR)) : residual df = 0</code>, which is fine but not as useful for
understanding this issue as what <code>anova</code> provides.<a href="chapter4.html#fnref94" class="footnote-back">↩︎</a></p></li>
<li id="fn95"><p>This is the first package we have encountered that is not on the “CRAN” repository and we will need to install it from its “github” repository. This happens for packages in early development and for other packages where researchers decide to avoid the ongoing challenges involved maintaining the package status on CRAN. In order to install this package, we can use the following code after installing the <code>remotes</code> <span class="citation">(<a href="#ref-R-remotes" role="doc-biblioref">Hester et al. 2021</a>)</span> package in the regular way: <code>library(remotes); remotes::install_github("mtennekes/tabplot")</code><a href="chapter4.html#fnref95" class="footnote-back">↩︎</a></p></li>
<li id="fn96"><p>In larger data sets,
multiple subjects are displayed in each row as proportions of
the rows in each category.<a href="chapter4.html#fnref96" class="footnote-back">↩︎</a></p></li>
<li id="fn97"><p>Quantitative variables are displayed with
boxplot-like bounds to describe the variability in the variable for that row of
responses for larger data sets.<a href="chapter4.html#fnref97" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Greenwood_Book.pdf"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
